<!DOCTYPE html><html><head>
      <title>README</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\jerry\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.10\crossnote\dependencies\katex\katex.min.css">
      
      
      <script type="text/javascript" src="file:///c:\Users\jerry\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.10\crossnote\dependencies\mermaid\mermaid.min.js" charset="UTF-8"></script>
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="从0开始卷出一个新项目之瑞萨ra6m5">从0开始卷出一个新项目之瑞萨RA6M5 </h1>

<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#从0开始卷出一个新项目之瑞萨ra6m5" class="md-toc-link"><p>从0开始卷出一个新项目之瑞萨RA6M5</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#一-范围" class="md-toc-link">
            <p>一、范围</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#二-目的" class="md-toc-link">
            <p>二、目的</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#三-瑞萨ra6m5简介" class="md-toc-link">
            <p>三、瑞萨RA6M5简介</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#四-瑞萨ra6m5应用" class="md-toc-link">
            <p>四、瑞萨RA6M5应用</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#五-分享内容" class="md-toc-link">
            <p>五、分享内容</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#六-硬件设计" class="md-toc-link">
            <p>六、硬件设计</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#七-软件设计" class="md-toc-link"><p>七、软件设计</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#71-配置分析" class="md-toc-link"><p>7.1 配置分析</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#711-ide等开发环境" class="md-toc-link">
            <p>7.1.1 IDE等开发环境</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#712-创建两个工程" class="md-toc-link">
            <p>7.1.2 创建两个工程</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#713-修改link文件" class="md-toc-link">
            <p>7.1.3 修改link文件</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#714-链接elf" class="md-toc-link">
            <p>7.1.4 链接elf</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#715-用fsp添加外设" class="md-toc-link">
            <p>7.1.5 用FSP添加外设</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#716-输出文件格式" class="md-toc-link">
            <p>7.1.6 输出文件格式</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#72-源码分析" class="md-toc-link"><p>7.2 源码分析</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#721-框图" class="md-toc-link">
            <p>7.2.1 框图</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#722-boot源码" class="md-toc-link"><p>7.2.2 boot源码</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#7221-boot源码分析" class="md-toc-link">
            <p>7.2.2.1 boot源码分析</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#72212-boot测试效果" class="md-toc-link">
            <p>7.2.2.12 boot测试效果</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#723-app源码" class="md-toc-link"><p>7.2.3 app源码</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#7231-app源码分析" class="md-toc-link">
            <p>7.2.3.1 app源码分析</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#72312-bootapp测试效果" class="md-toc-link">
            <p>7.2.3.12 boot+app测试效果</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#八-生成库和使用库" class="md-toc-link"><p>八、生成库和使用库</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#81-方法" class="md-toc-link">
            <p>8.1 方法</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#82-过程" class="md-toc-link">
            <p>8.2 过程</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#83-测试结果" class="md-toc-link">
            <p>8.3 测试结果</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#九-ra6m5工厂生产流程" class="md-toc-link"><p>九、RA6M5“工厂生产流程”</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#91-框图" class="md-toc-link">
            <p>9.1 框图</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#92-瑞萨renesas-flash-programmerrfp" class="md-toc-link"><p>9.2 瑞萨Renesas Flash Programmer（RFP）</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#921-rfp下载" class="md-toc-link">
            <p>9.2.1 RFP下载</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#922-相关文档" class="md-toc-link">
            <p>9.2.2 相关文档</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#93-ra启动模式" class="md-toc-link"><p>9.3 RA启动模式</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#931-boot硬件接口" class="md-toc-link">
            <p>9.3.1 boot硬件接口</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#932-boot软件接口" class="md-toc-link">
            <p>9.3.2 boot软件接口</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#94-ra-dlm生命周期管理" class="md-toc-link"><p>9.4 RA DLM（生命周期管理）</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#941-rpd分区文件" class="md-toc-link">
            <p>9.4.1 .rpd分区文件</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#942-dlm介绍" class="md-toc-link"><p>9.4.2 DLM介绍</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#9421-dlm模式转换图" class="md-toc-link">
            <p>9.4.2.1 DLM模式转换图</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#9422-dlm模式说明图" class="md-toc-link">
            <p>9.4.2.2 DLM模式说明图</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#9423-dlm-dpl部署到客户现场说明图" class="md-toc-link">
            <p>9.4.2.3 DLM-DPL部署到客户现场说明图</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#9424-dlm写入秘钥略" class="md-toc-link">
            <p>9.4.2.4 DLM写入秘钥（略）</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#9425-dlm结合公司项目开发" class="md-toc-link">
            <p>9.4.2.5 DLM结合公司项目开发</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#9426-演示rfp的使用" class="md-toc-link">
            <p>9.4.2.6 演示RFP的使用</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#9427-例程打印dlm模式和分区" class="md-toc-link">
            <p>9.4.2.7 例程打印DLM模式和分区</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#十-发布新固件-release和debug版本的差异" class="md-toc-link"><p>十、发布新固件---Release和Debug版本的差异</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#101-公司自行管理维护" class="md-toc-link">
            <p>10.1 公司自行管理维护</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#102-release和debug版本的差异" class="md-toc-link"><p>10.2 Release和Debug版本的差异</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#1021-引用文章" class="md-toc-link">
            <p>10.2.1 引用文章</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#1022-个人观点" class="md-toc-link">
            <p>10.2.2 个人观点</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#103-version存储" class="md-toc-link"><p>10.3 version存储</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#1031-e2studio-version-section" class="md-toc-link">
            <p>10.3.1 e2studio .version Section</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#1032-绝对定位__attribute__at" class="md-toc-link">
            <p>10.3.2 绝对定位__attribute__((at()))</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
</div>
<h2 id="一-范围">一、范围 </h2>
<h5 id="11-初次在项目中使用瑞萨ra">1.1 初次在项目中使用瑞萨RA </h5>
<h5 id="12-用过st等但不熟悉瑞萨环境">1.2 用过ST等但不熟悉瑞萨环境 </h5>
<h5 id="13-对嵌入式开发感兴趣">1.3 对嵌入式开发感兴趣 </h5>
<h2 id="二-目的">二、目的 </h2>
<p>通过boot+app两个工程源码和开发环境的分享，使得瑞萨RA6M5快速用于项目开发。</p>
<h2 id="三-瑞萨ra6m5简介">三、瑞萨RA6M5简介 </h2>
<p><img src="./images/ra6m5-blockdiagram.png" alt=""><br>
<img src="./images/RA.png" alt=""><br>
<img src="./images/fsp-block-diagram_10.png" alt=""><br>
<img src="./images/ek-ra6m5-board.png" alt=""></p>
<h2 id="四-瑞萨ra6m5应用">四、瑞萨RA6M5应用 </h2>
<h5 id="新能源">新能源 </h5>
<h5 id="充电桩">充电桩 </h5>
<h5 id="bms">BMS </h5>
<h5 id="dtu-rtu">DTU RTU </h5>
<p>蜂窝云连接系统<br>
交流变频器/GP 逆变器解决方案<br>
语音识别和智能控制<br>
基于 ROS 的机器人本体控制器<br>
micro-ROS Solutions<br>
Ubiquitous AI Edge Trust for RA MCUs<br>
工业用嵌入式可编程逻辑控制器 (PLC)<br>
无线多通道隔离数据记录器<br>
ABUP UA差分升级解决方案<br>
Remote Predictive Maintenance Solution<br>
远程预测性维护<br>
有线以太网应用<br>
需要增强安全功能的产品（火灾探测、防盗检测、面板控制）<br>
表计类产品（电力，自动抄表）<br>
工业应用（机器人、开门器、缝纫机、自动售货机、UPS）<br>
HVAC（供暖、空调、锅炉控制）</p>
<h2 id="五-分享内容">五、分享内容 </h2>
<h5 id="51-工程框图">5.1 工程框图 </h5>
<p><img src="./images/kuangtu.png" alt=""></p>
<h5 id="51-flash分区">5.1 flash分区 </h5>
<p><img src="./images/flash%20fenqv.png" alt=""></p>
<h5 id="51-软件资源">5.1 软件资源 </h5>
<p><img src="./images/gongchen%20ruanjian.png" alt=""></p>
<h2 id="六-硬件设计">六、硬件设计 </h2>
<h4 id="61-资料来源">6.1 资料来源 </h4>
<p><img src="./images/doc.png" alt=""></p>
<h5 id="611-官方ra6-快速设计指南-datasheet-users-manual-ek-designpackage">6.1.1 官方：RA6 快速设计指南、datasheet、User’s Manual、ek-designpackage </h5>
<p><img src="./images/ek.png" alt=""></p>
<h5 id="612-第三方野火启明6m5开发板-httpsdocembedfirecommcurenesasfsp_razhlatestindexhtml">6.1.2 第三方：野火启明6M5开发板 <a href="https://doc.embedfire.com/mcu/renesas/fsp_ra/zh/latest/index.html">https://doc.embedfire.com/mcu/renesas/fsp_ra/zh/latest/index.html</a> </h5>
<p><img src="./images/fire.png" alt=""><br>
<img src="./images/firedoc.png" alt=""></p>
<h5 id="613-嘉立创-b站等">6.1.3 嘉立创、b站等 </h5>
<p><img src="./images/lcsc.png" alt=""></p>
<h4 id="62-各部分设计">6.2 各部分设计 </h4>
<h5 id="621-电源">6.2.1 电源 </h5>
<pre class="language-text">VSS VSS **VCL** AVCC AVSS VREF VBAT
</pre>
<p><img src="./images/power.png" alt=""></p>
<h5 id="622-时钟">6.2.2 时钟 </h5>
<pre class="language-text">24M 32.768K(**注意未使用**) 25M 
</pre>
<p><img src="./images/clock.png" alt=""></p>
<h5 id="623-调试接口">6.2.3 调试接口 </h5>
<pre class="language-text">建议预留JTAG，非单SWD，上拉
</pre>
<p><img src="./images/debug.png" alt=""></p>
<h5 id="624--复位">6.2.4  复位 </h5>
<p><img src="./images/M33%20reset.png" alt=""></p>
<h5 id="625--串口-can-以太网">6.2.5  串口、CAN、以太网 </h5>
<pre class="language-text">上拉
</pre>
<h5 id="626-引脚分配">6.2.6 引脚分配 </h5>
<pre class="language-text">datasheet
</pre>
<p><img src="./images/pin%20list.png" alt=""></p>
<pre class="language-text">rasc分配导出表格
</pre>
<p><img src="./images/rasc%20pins.png" alt=""></p>
<h5 id="627--未使用引脚">6.2.7  未使用引脚 </h5>
<p><img src="./images/unused%20pins.png" alt=""></p>
<h5 id="628-原理图-pcb">6.2.8 原理图 PCB </h5>
<pre class="language-text">库文件
</pre>
<h2 id="七-软件设计">七、软件设计 </h2>
<h3 id="71-配置分析">7.1 配置分析 </h3>
<h4 id="711-ide等开发环境">7.1.1 IDE等开发环境 </h4>
<table>
<thead>
<tr>
<th style="text-align:center">集成开发环境<br>IDE</th>
<th style="text-align:center"><a href="https://www2.renesas.cn/cn/zh/software-tool/e-studio">e2studio</a></th>
<th style="text-align:center"><a href="https://www2.renesas.cn/cn/zh/software-tool/flexible-software-package-fsp#overview">fsp_v4_0_0_e2s</a></th>
<th style="text-align:center">MDK:<br>5.31</th>
<th style="text-align:center">IAR:<br>8.50.6</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>软件包</strong></td>
<td style="text-align:center">FPS</td>
<td style="text-align:center"><a href="https://github.com/renesas/fsp/releases">FPS</a></td>
<td style="text-align:center"><a href="https://github.com/renesas/fsp/releases">RA Smart Configurator(RASC)<br>fsp_v4_1_0_e2s</a></td>
<td style="text-align:center">RASC</td>
</tr>
<tr>
<td style="text-align:center"><strong>编译工具链<br>Toolchain</strong></td>
<td style="text-align:center">GCC Compiler</td>
<td style="text-align:center">GCC Compiler</td>
<td style="text-align:center">ARM Compiler</td>
<td style="text-align:center">IAR Compiler</td>
</tr>
<tr>
<td style="text-align:center"><strong>IDE特点</strong></td>
<td style="text-align:center">支持多种RenesasMCU<br>安装中下载FPS和Toolchain等等</td>
<td style="text-align:center">RA系列一键安装<br>包括了FPS和Toolchain</td>
<td style="text-align:center">RASC嵌入MDK<br>FPS和Toolchain</td>
<td style="text-align:center">RASC嵌入IAR<br>FPS和Toolchain</td>
</tr>
<tr>
<td style="text-align:center"><strong><a href="https://www.segger.com/downloads/jlink/">J-link烧写软件和硬件</a></strong></td>
<td style="text-align:center">SEGGER J-Link: <br>7.68b</td>
<td style="text-align:center">SEGGER J-Link: <br>7.68b</td>
<td style="text-align:center">SEGGER J-Link: <br>7.68b</td>
<td style="text-align:center">SEGGER J-Link: <br>7.68b</td>
</tr>
<tr>
<td style="text-align:center"><strong><a href="https://www2.renesas.cn/us/zh/software-tool/renesas-flash-programmer-programming-gui#overview">Renesas烧写软件</a></strong></td>
<td style="text-align:center">Renesas Flash Programme（RFP）</td>
<td style="text-align:center">RFP</td>
<td style="text-align:center">RFP</td>
<td style="text-align:center">RFP</td>
</tr>
<tr>
<td style="text-align:center">Renesas仿真硬件</td>
<td style="text-align:center"><a href="https://www2.renesas.cn/us/zh/software-tool/e2-emulator-lite-rte0t0002lkce00000r#overview">E2 emulator Lite</a><br><a href="https://www2.renesas.cn/us/zh/software-tool/e2-emulator-rte0t00020kce00000r#overview">E2 emulator</a></td>
<td style="text-align:center"><a href="https://www2.renesas.cn/us/zh/software-tool/e2-emulator-lite-rte0t0002lkce00000r#overview">E2 emulator Lite</a><br><a href="https://www2.renesas.cn/us/zh/software-tool/e2-emulator-rte0t00020kce00000r#overview">E2 emulator</a></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h4 id="712-创建两个工程">7.1.2 创建两个工程 </h4>
<pre class="language-text">使用e2sstudio创建boot+app两个带rtos的工程
注意芯片型号和编译工具
创建成功后debug运行测试
</pre>
<h4 id="713-修改link文件">7.1.3 修改link文件 </h4>
<p>/script<br>
fsp_boot.ld<br>
memory_regions_boot.ld</p>
<p>fsp_app.ld<br>
memory_regions_app.ld</p>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>RAM_START = 0x20000000;
RAM_LENGTH = 0x80000;
FLASH_START = 0x00000000;
FLASH_LENGTH = 0x010000;
DATA_FLASH_START = 0x08000000;
DATA_FLASH_LENGTH = 0x2000;
OPTION_SETTING_START = 0x0100A100;
OPTION_SETTING_LENGTH = 0x100;
OPTION_SETTING_S_START = 0x0100A200;
OPTION_SETTING_S_LENGTH = 0x100;
ID_CODE_START = 0x00000000;
ID_CODE_LENGTH = 0x0;
SDRAM_START = 0x90000000;
SDRAM_LENGTH = 0x0;
QSPI_FLASH_START = 0x60000000;
QSPI_FLASH_LENGTH = 0x4000000;
OSPI_DEVICE_0_START = 0x68000000;
OSPI_DEVICE_0_LENGTH = 0x8000000;
OSPI_DEVICE_1_START = 0x70000000;
OSPI_DEVICE_1_LENGTH = 0x10000000;
</code></pre><pre data-role="codeBlock" data-info="" class="language-text text"><code>unsigned long Boot_Addr = 0x10000;//memory_regions_boot.ld FLASH_LENGTH
printf("\n**************************************\n");
printf(  "**********JUMP TO APP:0x%lX**********\n", Boot_Addr);
printf(  "**************************************\n");

//close any peripherals before do_boot
g_uart9.p_api-&gt;close(&amp;g_uart9_ctrl);
R_FLASH_HP_Close(&amp;g_flash0_ctrl);

//jump
do_boot(Boot_Addr);
printf("this message cant print!\n");
</code></pre><pre class="language-text">flash分区
</pre>
<p><img src="./images/flash%20fenqv.png" alt=""></p>
<h4 id="714-链接elf">7.1.4 链接elf </h4>
<p><img src="./images/linkelf.png" alt=""></p>
<pre class="language-text">增加jump函数
测试debug和跳转功能
</pre>
<h4 id="715-用fsp添加外设">7.1.5 用FSP添加外设 </h4>
<pre class="language-text">boot
</pre>
<p><img src="./images/bootstack.png" alt=""></p>
<pre class="language-text">app
</pre>
<p><img src="./images/appstack.png" alt=""></p>
<p><img src="./images/gongchen%20ruanjian.png" alt=""></p>
<h4 id="716-输出文件格式">7.1.6 输出文件格式 </h4>
<p><img src="./images/outputmotorola.png" alt=""></p>
<p><img src="./images/outputpost.png" alt=""></p>
<pre class="language-text">${cross_prefix}${cross_objcopy}${cross_suffix} -O binary  -j .text -j .data  "${ProjName}.elf" "${ProjName}.bin"  ;${cross_prefix}${cross_objcopy}${cross_suffix} -O ihex -j .text -j .data  "${ProjName}.elf"  "${ProjName}.hex"
</pre>
<h3 id="72-源码分析">7.2 源码分析 </h3>
<h4 id="721-框图">7.2.1 框图 </h4>
<p><img src="./images/kuangtu.png" alt=""></p>
<h4 id="722-boot源码">7.2.2 boot源码 </h4>
<h5 id="7221-boot源码分析">7.2.2.1 boot源码分析 </h5>
<p><img src="./images/bootsrc1.png" alt=""></p>
<pre class="language-text">boot中只有一个线程
//jump，跳转前关闭外设，关闭中断，注意带rtos需要的处理
do_boot(Boot_Addr);
如果不需要通过网络升级固件，则不添加网络协议栈，可用串口升级。
</pre>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>void boot_thread0_entry(void *pvParameters)
{
    FSP_PARAMETER_NOT_USED (pvParameters);

///////////////////////////////////////////////////////////////////////////
    fsp_err_t err = FSP_SUCCESS;
    err = g_uart9.p_api-&gt;open(&amp;g_uart9_ctrl, &amp;g_uart9_cfg);
    if(err == FSP_SUCCESS)
    {
        const char *log_uart_init = "\nboot log uart init successed!!!\r\n";
        g_uart9.p_api-&gt;write(&amp;g_uart9_ctrl, (uint8_t*)log_uart_init, strlen(log_uart_init));
        while(uart_send_complete_flag == false)
        {;}
        uart_send_complete_flag = false;
    }
    printf("\nprintf redirect successed!!!\ndate:%s\ntime:%s\nfile:%s\nfunc:%s,line:%d\nhello world!\n", __DATE__, __TIME__, __FILE__, __FUNCTION__, __LINE__);

    check_reset_status();

    /* Open Flash_HP */
    err = R_FLASH_HP_Open(&amp;g_flash0_ctrl, &amp;g_flash0_cfg);
    /* Handle Error */
    if (FSP_SUCCESS != err)
    {
        printf("R_FLASH_HP_Open API failed=%d", err);
    }

    uint8_t fwUpgradeFlg = 0;
    /*Read code flash data */
    readCodeFlash((uint8_t *) FLASH_HP_CF_BLCOK_69, &amp;fwUpgradeFlg, sizeof(fwUpgradeFlg));
    printf("fwUpgradeFlg=%d", fwUpgradeFlg);

    if(fwUpgradeFlg == 1)
    {
        //do frameware upgrade over Ethernet or other
        //creat frameware thread
        //download frameware and check crc
        //write fwUpgradeFlg = 1, jump to app or reset
    }
    else
    {
        unsigned long Boot_Addr = 0x10000;//memory_regions_boot.ld FLASH_LENGTH
        printf("\n**************************************\n");
        printf(  "**********JUMP TO APP:0x%lX**********\n", Boot_Addr);
        printf(  "**************************************\n");

        //close any peripherals before do_boot
        g_uart9.p_api-&gt;close(&amp;g_uart9_ctrl);
        R_FLASH_HP_Close(&amp;g_flash0_ctrl);

        //jump
        do_boot(Boot_Addr);

        printf("this message cant print!\n");
    }
///////////////////////////////////////////////////////////////////////////
    /* TODO: add your own code here */
    while (1)
    {
        vTaskDelay (1);
    }
}
</code></pre><p><strong>FreeRTOS-Plus-TCP</strong></p>
<p><img src="./images/visitfreertostcp.png" alt=""><br>
CSDN当前主流的小型嵌入式网络协议栈:<a href="https://blog.csdn.net/Simon223/article/details/115673495">https://blog.csdn.net/Simon223/article/details/115673495</a><br>
freertos对比lwip：<a href="https://www.freertos.org/FreeRTOS_Support_Forum_Archive/November_2014/freertos_FreeRTOS_TCP_IP_stack_vs_lwIP_8324ceabj.html">https://www.freertos.org/FreeRTOS_Support_Forum_Archive/November_2014/freertos_FreeRTOS_TCP_IP_stack_vs_lwIP_8324ceabj.html</a></p>
<pre class="language-text">ChatGPT做的几款小型嵌入式网络协议栈的对比，仅供参考
</pre>
<table>
<thead>
<tr>
<th>协议栈</th>
<th>所属组织</th>
<th>最早时间</th>
<th>最新版本号</th>
<th>是否免费商用</th>
<th>许可证</th>
<th>优劣势</th>
<th>所需 Flash</th>
<th>所需 RAM</th>
</tr>
</thead>
<tbody>
<tr>
<td>embTCP</td>
<td><a href="http://lwip.org/">lwIP.org</a>（LwIP）</td>
<td>2005</td>
<td>2.5.3</td>
<td>是</td>
<td>BSD</td>
<td>占用系统资源极少，运行速度快。提供了核心 TCP/IP 功能。</td>
<td>30KB</td>
<td>3.5KB</td>
</tr>
<tr>
<td>FreeRTOS-Plus-TCP</td>
<td><a href="https://aws.amazon.com/">Amazon Web Services</a></td>
<td>Unknown</td>
<td>2.2.2</td>
<td>是</td>
<td>GPL</td>
<td>集成度高，易于移植，支持 IPv4 和 IPv6。</td>
<td>30KB+</td>
<td>10KB+</td>
</tr>
<tr>
<td>LwIP</td>
<td><a href="https://www.sics.se/">Swedish Institute of Computer Science (SICS)</a>, <a href="http://lwip.org/">lwIP.org</a></td>
<td>2001</td>
<td>2.1.2</td>
<td>是</td>
<td>BSD</td>
<td>小巧、灵活，提供了 TCP/IP 功能以及丰富的应用层协议。</td>
<td>40KB</td>
<td>10KB</td>
</tr>
<tr>
<td>Nanostack</td>
<td><a href="https://www.arm.com/">ARM</a></td>
<td>2014</td>
<td>3.6.0</td>
<td>是</td>
<td>Apache</td>
<td>可靠性高，提供了易于使用的 API，并支持 IPv6。</td>
<td>50KB</td>
<td>10KB</td>
</tr>
<tr>
<td>uIP</td>
<td><a href="https://dunkels.com/adam/">Adam Dunkels</a></td>
<td>2002</td>
<td>1.0</td>
<td>是</td>
<td>BSD</td>
<td>轻量级、支持 IPv4 和 TCP/IP，占用资源非常少。</td>
<td>4KB</td>
<td>1.5KB</td>
</tr>
</tbody>
</table>
<h5 id="72212-boot测试效果">7.2.2.12 boot测试效果 </h5>
<pre class="language-text">串口日志
</pre>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>boot log uart init successed!!!

printf redirect successed!!!
date:Jun 18 2023
time:20:12:37
file:../src/boot_thread0_entry.c
func:boot_thread0_entry,line:226
hello world!

RSTSR0=0 RSTSR1=0 RSTSR2=0

************************ Cold start ************************
fwUpgradeFlg=255
**************************************
**********JUMP TO APP:0x10000**********
**************************************
</code></pre><h4 id="723-app源码">7.2.3 app源码 </h4>
<h5 id="7231-app源码分析">7.2.3.1 app源码分析 </h5>
<p><img src="./images/appsrc1.png" alt=""></p>
<table>
<thead>
<tr>
<th>app线程</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>线程0 start_thread0_entry</td>
<td>日志和监控</td>
</tr>
<tr>
<td>线程1 tcp_thread1_entry</td>
<td>云端通讯</td>
</tr>
<tr>
<td>线程2 uart_thread2_entry</td>
<td>本地通讯</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>线程0 start_thread0_entry</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>移植easylogger</td>
<td>日志分级别</td>
</tr>
<tr>
<td>fsp littlefs</td>
<td>dataflash保存经常变化数据</td>
</tr>
<tr>
<td>移植shell</td>
<td>监控系统状态</td>
</tr>
<tr>
<td>移植ring buffer</td>
<td>shell串口数据依赖</td>
</tr>
</tbody>
</table>
<pre class="language-text">流程图：
</pre>
<div class="mermaid">graph TD;
    A1[线程0&lt;br/&gt;start_thread0_entry]--&gt;A[一 日志串口初始化&lt;br/&gt;g_uart9.p_api-&gt;open];
    A[一 日志串口初始化&lt;br/&gt;g_uart9.p_api-&gt;open]--&gt;B[测试打印&lt;br/&gt;g_uart9.p_api-&gt;write];
    B[测试打印&lt;br/&gt;g_uart9.p_api-&gt;write]--&gt;C[printf打印:&lt;br/&gt;编译时间&lt;br/&gt;fsp版本&lt;br/&gt;fsp stackheap等&lt;br/&gt;uniqueID&lt;br/&gt;MAC];
    C[printf打印:&lt;br/&gt;编译时间&lt;br/&gt;fsp版本&lt;br/&gt;fsp stackheap等&lt;br/&gt;uniqueID&lt;br/&gt;MAC]--&gt;D[二 日志文件初始化&lt;br/&gt;g_rm_littlefs0.p_api-&gt;open];
    D[二 日志文件初始化&lt;br/&gt;g_rm_littlefs0.p_api-&gt;open]--&gt;E[测试文件系统&lt;br/&gt;重启测试];
    E[测试文件系统&lt;br/&gt;重启次数]--&gt;F[三 初始化easylogger];
    F[三 初始化&lt;br/&gt;easylogger]--&gt;G[四 测试&lt;br/&gt;easylogger];
    G[四 初始化&lt;br/&gt;shell和ring buffer]--&gt;H[五 线程循环&lt;br/&gt;shell解析];
    H[无 线程循环&lt;br/&gt;shell解析]--&gt;I[--help&lt;br/&gt;--information&lt;br/&gt;--highwater&lt;br/&gt;--freeheap&lt;br/&gt;--dietemp&lt;br/&gt;times];
    I[--help&lt;br/&gt;--information&lt;br/&gt;--highwater&lt;br/&gt;--freeheap&lt;br/&gt;--dietemp&lt;br/&gt;--times]--&gt;J[vTaskDelay];
    J[vTaskDelay 100]--&gt;H[线程循环&lt;br/&gt;shell解析];

    A2[线程1&lt;br/&gt;tcp_thread1_entry]--&gt;B2[测试打印&lt;br/&gt;tcp_thread1_entry];
    B2[测试打印&lt;br/&gt;tcp_thread1_entry]--&gt;C2[线程循环];
    C2[线程循环]--&gt;D2[测试打印&lt;br/&gt;tcp_thread1_thread];
    D2[测试打印&lt;br/&gt;tcp_thread1_thread]--&gt;E2[vTaskDelay 5000];
    E2[vTaskDelay 5000]--&gt;C2[线程循环];

    A3[线程1&lt;br/&gt;uart_thread2_entry]--&gt;B3[测试打印&lt;br/&gt;uart_thread2_entry];
    B3[测试打印&lt;br/&gt;uart_thread2_entry]--&gt;C3[线程循环];
    C3[线程循环]--&gt;D3[测试打印&lt;br/&gt;uart_thread2_thread];
    D3[测试打印&lt;br/&gt;uart_thread2_thread]--&gt;E3[vTaskDelay 5000];
    E3[vTaskDelay 5000]--&gt;C3[线程循环];
</div><pre class="language-text">复制线程源码：
</pre>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>void start_thread0_entry(void *pvParameters)
{
    FSP_PARAMETER_NOT_USED (pvParameters);

///////////////////////////////////////////////////////////////////////////
    fsp_err_t err = FSP_SUCCESS;
    ring_buffer_init(&amp;uart9_RxBuf);
    err = g_uart9.p_api-&gt;open(&amp;g_uart9_ctrl, &amp;g_uart9_cfg);
    if(err == FSP_SUCCESS)
    {
        const char *log_uart_init = "\napp log uart init successed!!!\r\n";
        g_uart9.p_api-&gt;write(&amp;g_uart9_ctrl, (uint8_t*)log_uart_init, strlen(log_uart_init));
        while(uart_send_complete_flag == false)
        {;}
        uart_send_complete_flag = false;
    }
    printf("\nprintf redirect successed!!!\ndate:%s\ntime:%s\nfile:%s\nfunc:%s,line:%d\nhello world!\n", __DATE__, __TIME__, __FILE__, __FUNCTION__, __LINE__);

    fsp_pack_version_t version;
    R_FSP_VersionGet(&amp;version);
    const uint8_t versionstr[] = FSP_VERSION_BUILD_STRING;
    printf("fsp:%s", versionstr);

    const uint32_t bspVCC = BSP_CFG_MCU_VCC_MV;
    const uint32_t bspStack = BSP_CFG_STACK_MAIN_BYTES;
    const uint32_t bspHeap = BSP_CFG_HEAP_BYTES;
    printf("bspVCC=%d MV,bspStack:%d Byte,bspHeap=%d Byte", (int)bspVCC, (int)bspStack, (int)bspHeap);

    volatile const bsp_unique_id_t * uniqueID;
    uniqueID = R_BSP_UniqueIdGet();
    printf("uniqueID:%08X%08X%08X%08X", (unsigned int)uniqueID-&gt;unique_id_words[0],(unsigned int)uniqueID-&gt;unique_id_words[1],(unsigned int)uniqueID-&gt;unique_id_words[2],(unsigned int)uniqueID-&gt;unique_id_words[3]);
    printf("MAC:%02X%02X%02X%02X%02X%02X",g_ether0.p_cfg-&gt;p_mac_address[0],g_ether0.p_cfg-&gt;p_mac_address[1],g_ether0.p_cfg-&gt;p_mac_address[2],g_ether0.p_cfg-&gt;p_mac_address[3],g_ether0.p_cfg-&gt;p_mac_address[4],g_ether0.p_cfg-&gt;p_mac_address[5]);

///////////////////////////////////////////////////////////////////////////

#if 1//test
    /* if littlefs enable thread safe,must copy to common_data.c  g_rm_littlefs0_lfs_cfg,FSP 4.4.0 bug
    #ifdef LFS_THREAD_SAFE
    .lock = &amp;rm_littlefs_flash_lock,
    .unlock = &amp;rm_littlefs_flash_unlock,
    #endif
     */
    err = g_rm_littlefs0.p_api-&gt;open(&amp;g_rm_littlefs0_ctrl, &amp;g_rm_littlefs0_cfg);
    if(FSP_SUCCESS != err)
    {
        printf("g_rm_littlefs0.p_api-&gt;open err=%d\r\n", err);
        g_rm_littlefs0.p_api-&gt;close(&amp;g_rm_littlefs0_ctrl);
    }
    printf("g_rm_littlefs0.p_api-&gt;open successed!!!\n");

    err = lfs_mount(&amp;g_rm_littlefs0_lfs, &amp;g_rm_littlefs0_lfs_cfg);
    if( err )
    {
        printf("lfs_mount err=%d\r\n", err);
        lfs_format(&amp;g_rm_littlefs0_lfs, &amp;g_rm_littlefs0_lfs_cfg);
        lfs_mount(&amp;g_rm_littlefs0_lfs, &amp;g_rm_littlefs0_lfs_cfg);
    }


    // read current count
    uint32_t boot_count2 = 0;
    lfs_file_open(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file, "boot_count2", LFS_O_RDWR | LFS_O_CREAT);
    lfs_file_read(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file, &amp;boot_count2, sizeof(boot_count2));
    printf("g_log_lfs_file.id ID:%d\r\n", g_log_lfs_file.id);

    // update boot count
    boot_count2 += 1;
    lfs_file_rewind(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file);
    lfs_file_write(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file, &amp;boot_count2, sizeof(boot_count2));

    // remember the storage is not updated until the file is closed successfully
    lfs_file_close(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file);

    uint32_t txt2 = 0;
    lfs_file_open(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file, "txt2", LFS_O_RDWR | LFS_O_CREAT);
    lfs_file_read(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file, &amp;txt2, sizeof(txt2));
    printf("ID:%d\r\n", g_log_lfs_file.id);

    // update boot count
    txt2 += 1;
    lfs_file_rewind(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file);
    lfs_file_write(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file, &amp;txt2, sizeof(txt2));

    // remember the storage is not updated until the file is closed successfully
    lfs_file_close(&amp;g_rm_littlefs0_lfs, &amp;g_log_lfs_file);

    // release any resources we were using
    lfs_unmount(&amp;g_rm_littlefs0_lfs);

    // print the boot count
    printf("boot_count2: %ld\r\n", boot_count2);
    printf("txt2: %ld\r\n", txt2);
    printf("\r\n");
#endif
    ///////////////////////////////////////////////////
    ///
    elog_init();
#if 0
    elog_set_fmt(ELOG_LVL_ASSERT, ELOG_FMT_ALL &amp; ~ELOG_FMT_P_INFO);
    elog_set_fmt(ELOG_LVL_ERROR, ELOG_FMT_LVL | ELOG_FMT_TAG | ELOG_FMT_TIME);
    elog_set_fmt(ELOG_LVL_WARN, ELOG_FMT_LVL | ELOG_FMT_TAG | ELOG_FMT_TIME);
    elog_set_fmt(ELOG_LVL_INFO, ELOG_FMT_LVL | ELOG_FMT_TAG | ELOG_FMT_TIME);
    elog_set_fmt(ELOG_LVL_DEBUG, ELOG_FMT_ALL &amp; ~(ELOG_FMT_FUNC | ELOG_FMT_P_INFO));
    elog_set_fmt(ELOG_LVL_VERBOSE, ELOG_FMT_ALL &amp; ~(ELOG_FMT_FUNC | ELOG_FMT_P_INFO));
#else
    /* set EasyLogger log format */
    elog_set_fmt(ELOG_LVL_ASSERT, ELOG_FMT_ALL);
    elog_set_fmt(ELOG_LVL_ERROR, ELOG_FMT_LVL | ELOG_FMT_TAG | ELOG_FMT_TIME);
    elog_set_fmt(ELOG_LVL_WARN, ELOG_FMT_LVL | ELOG_FMT_TAG | ELOG_FMT_TIME);
    elog_set_fmt(ELOG_LVL_INFO, ELOG_FMT_LVL | ELOG_FMT_TAG | ELOG_FMT_TIME);
    elog_set_fmt(ELOG_LVL_DEBUG, ELOG_FMT_ALL &amp; ~(ELOG_FMT_FUNC | ELOG_FMT_T_INFO | ELOG_FMT_P_INFO));
    elog_set_fmt(ELOG_LVL_VERBOSE, ELOG_FMT_ALL &amp; ~(ELOG_FMT_FUNC | ELOG_FMT_T_INFO | ELOG_FMT_P_INFO));
#endif
    //start easylogger
    elog_start();
    vTaskDelay(1000);
#if 1//test easylogger
    log_a("Hello EasyLogger!");//断言 assert
    // A/NO_TAG   [10:08:12 pid:1008 tid:24] (../Core/Src/freertos.c LED_TASK03:207)Hello EasyLogger!
    log_e("Hello EasyLogger!");//error
    // E/NO_TAG   [10:08:12] Hello EasyLogger!
    log_w("Hello EasyLogger!");//waring
    // W/NO_TAG   [10:08:12] Hello EasyLogger!
    log_i("Hello EasyLogger!");//info
    // I/NO_TAG   [10:08:12] Hello EasyLogger!
    log_d("Hello EasyLogger!");//dbug
    // D/NO_TAG   [10:08:12] (../Core/Src/freertos.c:211)Hello EasyLogger!
    log_v("Hello EasyLogger!");//日志
    //V/NO_TAG   [10:08:12] (../Core/Src/freertos.c:212)Hello EasyLogger!

    uint8_t buf[256]= {0};
    uint16_t i = 0;

    for (i = 0; i &lt; sizeof(buf); i++)
    {
        buf[i] = (uint8_t)i;
    }
    elog_hexdump("test", 16, buf, sizeof(buf));
    log_d("\nTEXT END!\n");
#endif
///////////////////////////////////////////////////////////////////////////

    //init simple shell, then start it
    shell_init();
    shell_register("shell", shell);
    log_i("shell: welcome to shell ra6m5");


    /* TODO: add your own code here */
    while (1)
    {
        //get strings from uart0 rx ring buffer
        if(!ring_buffer_is_empty(&amp;uart9_RxBuf))
        {
            //get strings from uart0 rx ring buffer
            uint8_t cnt = ring_buffer_dequeue_arr(&amp;uart9_RxBuf, (char*)rx, sizeof(uart9_RxBuf.buffer));
            //log_i("rx=%s cnt=%d",rx,cnt);//print input string for test

            //shell parse, shell register callback 'shell'
            uint8_t res = shell_parse((char *)rx, cnt);

            //shell parse result informations
            if (res == 0)
            {
                /* run success */
            }
            else if (res == 1)
            {
                log_i("shell: run failed.\n");
            }
            else if (res == 2)
            {
                log_i("shell: unknown command.\n");
            }
            else if (res == 3)
            {
                log_i("shell: length is too long.\n");
            }
            else if (res == 4)
            {
                log_i("shell: pretreat failed.\n");
            }
            else if (res == 5)
            {
                log_i("shell: param is invalid.\n");
            }
            else
            {
                log_i("shell: unknown status code.\n");
            }
        }

        vTaskDelay (100);
    }
}
</code></pre><h5 id="72312-bootapp测试效果">7.2.3.12 boot+app测试效果 </h5>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>boot log uart init successed!!!

printf redirect successed!!!
date:Jun 18 2023
time:20:12:37
file:../src/boot_thread0_entry.c
func:boot_thread0_entry,line:226
hello world!

RSTSR0=0 RSTSR1=0 RSTSR2=0

************************ Cold start ************************
fwUpgradeFlg=255
**************************************
**********JUMP TO APP:0x10000**********
**************************************

app log uart init successed!!!

printf redirect successed!!!
date:Jun 18 2023
time:19:53:43
file:../src/start_thread0_entry.c
func:start_thread0_entry,line:439
hello world!
fsp:Built with Renesas Advanced Flexible Software Package version 4.4.0bspVCC=3300 MV,bspStack:8192 Byte,bspHeap=8192 ByteuniqueID:2D033F8E5736363299DA4E364E4B292DMAC:001122334455g_rm_littlefs0.p_api-&gt;open successed!!!
g_log_lfs_file.id ID:0
ID:1
boot_count2: 181
txt2: 180

I/elog    [42] EasyLogger V2.2.99 is initialize success.
I/TCP_TAG [47] tcp_thread1_entry
I/TCP_TAG [50] tcp_thread1_thread
I/UART_TAG [53] uart_thread2_entry
I/UART_TAG [56] uart_thread2_thread
A/INIT_TAG [1047  ] (../src/start_thread0_entry.c:540 start_thread0_entry)Hello EasyLogger!
E/INIT_TAG [1055] Hello EasyLogger!
W/INIT_TAG [1058] Hello EasyLogger!
I/INIT_TAG [1061] Hello EasyLogger!
D/INIT_TAG [1064] (../src/start_thread0_entry.c 548)Hello EasyLogger!
V/INIT_TAG [1070] (../src/start_thread0_entry.c 550)Hello EasyLogger!
D/HEX test: 0000-000F: 00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F    ................
D/HEX test: 0010-001F: 10 11 12 13 14 15 16 17  18 19 1A 1B 1C 1D 1E 1F    ................
D/HEX test: 0020-002F: 20 21 22 23 24 25 26 27  28 29 2A 2B 2C 2D 2E 2F     !"#$%&amp;'()*+,-./
D/HEX test: 0030-003F: 30 31 32 33 34 35 36 37  38 39 3A 3B 3C 3D 3E 3F    0123456789:;&lt;=&gt;?
D/HEX test: 0040-004F: 40 41 42 43 44 45 46 47  48 49 4A 4B 4C 4D 4E 4F    @ABCDEFGHIJKLMNO
D/HEX test: 0050-005F: 50 51 52 53 54 55 56 57  58 59 5A 5B 5C 5D 5E 5F    PQRSTUVWXYZ[\]^_
D/HEX test: 0060-006F: 60 61 62 63 64 65 66 67  68 69 6A 6B 6C 6D 6E 6F    `abcdefghijklmno
D/HEX test: 0070-007F: 70 71 72 73 74 75 76 77  78 79 7A 7B 7C 7D 7E 7F    pqrstuvwxyz{|}~.
D/HEX test: 0080-008F: 80 81 82 83 84 85 86 87  88 89 8A 8B 8C 8D 8E 8F    ................
D/HEX test: 0090-009F: 90 91 92 93 94 95 96 97  98 99 9A 9B 9C 9D 9E 9F    ................
D/HEX test: 00A0-00AF: A0 A1 A2 A3 A4 A5 A6 A7  A8 A9 AA AB AC AD AE AF    ................
D/HEX test: 00B0-00BF: B0 B1 B2 B3 B4 B5 B6 B7  B8 B9 BA BB BC BD BE BF    ................
D/HEX test: 00C0-00CF: C0 C1 C2 C3 C4 C5 C6 C7  C8 C9 CA CB CC CD CE CF    ................
D/HEX test: 00D0-00DF: D0 D1 D2 D3 D4 D5 D6 D7  D8 D9 DA DB DC DD DE DF    ................
D/HEX test: 00E0-00EF: E0 E1 E2 E3 E4 E5 E6 E7  E8 E9 EA EB EC ED EE EF    ................
D/HEX test: 00F0-00FF: F0 F1 F2 F3 F4 F5 F6 F7  F8 F9 FA FB FC FD FE FF    ................
D/INIT_TAG [1208] (../src/start_thread0_entry.c 561)
TEXT END!

I/INIT_TAG [1214] shell: welcome to shell ra6m5
I/TCP_TAG [2376475] tcp_thread1_thread
I/UART_TAG [2376481] uart_thread2_thread
I/INIT_TAG [2380884] Usage:
I/INIT_TAG [2380886]   shell (-h | --help)
I/INIT_TAG [2380890]   shell (-i | --information)
I/INIT_TAG [2380894]   shell (-g highwater | --get=highwater)
I/INIT_TAG [2380899]   shell (-g freeheap | --get=freeheap)
I/INIT_TAG [2380905]   shell (-g dietemp | --get=dietemp)
I/INIT_TAG [2380910] Options:
I/INIT_TAG [2380912]       --times=&lt;num&gt;    Set the running times.([default: 3])

I/TCP_TAG [2381478] tcp_thread1_thread
I/UART_TAG [2381484] uart_thread2_thread
I/TCP_TAG [2386481] tcp_thread1_thread
I/UART_TAG [2386487] uart_thread2_thread
I/TCP_TAG [2391484] tcp_thread1_thread
I/UART_TAG [2391490] uart_thread2_thread
</code></pre><h2 id="八-生成库和使用库">八、生成库和使用库 </h2>
<h3 id="81-方法">8.1 方法 </h3>
<pre class="language-text">e2s帮助功能:生成库+创建CDT
</pre>
<p><img src="./images/helplib.png" alt=""><br>
<img src="./images/creatlib.png" alt=""><br>
<img src="./images/uselib.png" alt=""></p>
<h3 id="82-过程">8.2 过程 </h3>
<pre class="language-text">生成库
</pre>
<p><img src="./images/clickstaticlib.png" alt=""><br>
<img src="./images/setstaticlib.png" alt=""><br>
<img src="./images/libafile.png" alt=""></p>
<pre class="language-text">创建CDT工程
</pre>
<p><img src="./images/creatcdc.png" alt=""><br>
<img src="./images/creatcdc2.png" alt=""><br>
<img src="./images/uselibprj.png" alt=""></p>
<pre class="language-text">链接库
</pre>
<h3 id="83-测试结果">8.3 测试结果 </h3>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>#include "tcp_thread1.h"

#define LOG_TAG          "TCP_TAG"
#define LOG_LVL          ELOG_LVL_VERBOSE
#include "elog.h"

/* Tcp Thread entry function */
/* pvParameters contains TaskHandle_t */
void tcp_thread1_entry(void *pvParameters)
{
    FSP_PARAMETER_NOT_USED (pvParameters);
    log_i("tcp_thread1_entry");
    /* TODO: add your own code here */
    while (1)
    {
        log_i("tcp_thread1_thread in app test");
        vTaskDelay (5000);
    }
}
</code></pre><pre data-role="codeBlock" data-info="" class="language-text text"><code>#include "uart_thread2.h"

#define LOG_TAG          "UART_TAG"
#define LOG_LVL          ELOG_LVL_VERBOSE
#include "elog.h"

/* Uart Thread entry function */
/* pvParameters contains TaskHandle_t */
void uart_thread2_entry(void *pvParameters)
{
    FSP_PARAMETER_NOT_USED (pvParameters);
    log_i("uart_thread2_entry");
    /* TODO: add your own code here */
    while (1)
    {
        log_i("uart_thread2_thread in app test");
        vTaskDelay (5000);
    }
}
</code></pre><pre class="language-text">链接选项修改
</pre>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>--specs=rdimon.specs -Wl,--whole-archive -lra6m5_app -Wl,--no-whole-archive
-Wl,--whole-archive -lra6m5_app -Wl,--no-whole-archive
</code></pre><pre data-role="codeBlock" data-info="" class="language-text text"><code>app log uart init successed!!!

printf redirect successed!!!
date:Jun 29 2023
time:18:18:36
file:../src/start_thread0_entry.c
func:start_thread0_entry,line:438
hello world!
fsp:Built with Renesas Advanced Flexible Software Package version 4.4.0bspVCC=3300 MV,bspStack:8192 Byte,bspHeap=8192 ByteuniqueID:2D033F8E5736363299DA4E364E4B292DMAC:001122334455g_rm_littlefs0.p_api-&gt;open successed!!!
g_log_lfs_file.id ID:0
ID:1
boot_count2: 4
txt2: 4

I/elog    [43] EasyLogger V2.2.99 is initialize success.
I/TCP_TAG [48] tcp_thread1_entry
I/TCP_TAG [51] tcp_thread1_thread in app test
I/UART_TAG [55] uart_thread2_entry
I/UART_TAG [58] uart_thread2_thread in app test
A/INIT_TAG [1048  ] (../src/start_thread0_entry.c:539 start_thread0_entry)Hello EasyLogger!
E/INIT_TAG [1056] Hello EasyLogger!
W/INIT_TAG [1059] Hello EasyLogger!
I/INIT_TAG [1062] Hello EasyLogger!
D/INIT_TAG [1065] (../src/start_thread0_entry.c 547)Hello EasyLogger!
V/INIT_TAG [1071] (../src/start_thread0_entry.c 549)Hello EasyLogger!
D/HEX test: 0000-000F: 00 01 02 03 04 05 06 07  08 09 0A 0B 0C 0D 0E 0F    ................
D/HEX test: 0010-001F: 10 11 12 13 14 15 16 17  18 19 1A 1B 1C 1D 1E 1F    ................
D/HEX test: 0020-002F: 20 21 22 23 24 25 26 27  28 29 2A 2B 2C 2D 2E 2F     !"#$%&amp;'()*+,-./
D/HEX test: 0030-003F: 30 31 32 33 34 35 36 37  38 39 3A 3B 3C 3D 3E 3F    0123456789:;&lt;=&gt;?
D/HEX test: 0040-004F: 40 41 42 43 44 45 46 47  48 49 4A 4B 4C 4D 4E 4F    @ABCDEFGHIJKLMNO
D/HEX test: 0050-005F: 50 51 52 53 54 55 56 57  58 59 5A 5B 5C 5D 5E 5F    PQRSTUVWXYZ[\]^_
D/HEX test: 0060-006F: 60 61 62 63 64 65 66 67  68 69 6A 6B 6C 6D 6E 6F    `abcdefghijklmno
D/HEX test: 0070-007F: 70 71 72 73 74 75 76 77  78 79 7A 7B 7C 7D 7E 7F    pqrstuvwxyz{|}~.
D/HEX test: 0080-008F: 80 81 82 83 84 85 86 87  88 89 8A 8B 8C 8D 8E 8F    ................
D/HEX test: 0090-009F: 90 91 92 93 94 95 96 97  98 99 9A 9B 9C 9D 9E 9F    ................
D/HEX test: 00A0-00AF: A0 A1 A2 A3 A4 A5 A6 A7  A8 A9 AA AB AC AD AE AF    ................
D/HEX test: 00B0-00BF: B0 B1 B2 B3 B4 B5 B6 B7  B8 B9 BA BB BC BD BE BF    ................
D/HEX test: 00C0-00CF: C0 C1 C2 C3 C4 C5 C6 C7  C8 C9 CA CB CC CD CE CF    ................
D/HEX test: 00D0-00DF: D0 D1 D2 D3 D4 D5 D6 D7  D8 D9 DA DB DC DD DE DF    ................
D/HEX test: 00E0-00EF: E0 E1 E2 E3 E4 E5 E6 E7  E8 E9 EA EB EC ED EE EF    ................
D/HEX test: 00F0-00FF: F0 F1 F2 F3 F4 F5 F6 F7  F8 F9 FA FB FC FD FE FF    ................
D/INIT_TAG [1209] (../src/start_thread0_entry.c 560)
TEXT END!

I/INIT_TAG [1214] shell: welcome to shell ra6m5
I/TCP_TAG [5055] tcp_thread1_thread in app test
I/UART_TAG [5062] uart_thread2_thread in app test
I/TCP_TAG [10059] tcp_thread1_thread in app test
I/UART_TAG [10066] uart_thread2_thread in app test
I/TCP_TAG [15063] tcp_thread1_thread in app test
I/UART_TAG [15070] uart_thread2_thread in app test
</code></pre><h2 id="九-ra6m5工厂生产流程">九、RA6M5“工厂生产流程” </h2>
<p>抛砖引玉。这里把工厂烧写固件、设置读保护、产测流程统称为“<strong>工厂生产流程</strong>”。主要介绍工厂烧写、产测流程的做法和注意事项。引出简介瑞萨DLM芯片生命周期管理、Arm® （CM33）的TrustZone® 。</p>
<h3 id="91-框图">9.1 框图 </h3>
<p>这是最常见MCU工厂烧录方式：</p>
<pre class="language-text">a、使用治具，通过segger jlink或瑞萨RFP Jlink/串口烧写bin/hex等固件文件
b、设置flash读保护（DLM切换状态），保护固件被读取破解
c、产测流程，确保pcba正常。常把上述软件嵌入到公司的系统软件中。
</pre>
<p><strong>框图：</strong><br>
<img src="./images/factory%20test.png" alt=""></p>
<h3 id="92-瑞萨renesas-flash-programmerrfp">9.2 瑞萨Renesas Flash Programmer（RFP） </h3>
<pre class="language-text">正常模式：RFP可以读写RA6M5固件（同segger j-flash）
引导模式：RFP可以读写RA6M5固件、读写配置、DLM关联相关功能等等
</pre>
<h4 id="921-rfp下载">9.2.1 RFP下载 </h4>
<p><img src="./images/rfp%20download.png" alt=""><br>
<img src="./images/rfp%20download1.png" alt=""><br>
<img src="./images/rfp%20gui.png" alt=""></p>
<h4 id="922-相关文档">9.2.2 相关文档 </h4>
<p>1、<a href="https://www.renesas.cn/cn/zh/document/mat/renesas-flash-programmer-v312-flash-memory-programming-software-users-manual?r=488871">Renesas Flash Programmer V3.12</a><br>
2、<a href="https://www.renesas.cn/cn/zh/document/apn/standard-boot-firmware-ra-family-mcus-based-arm-cortex-m33?language=en&amp;r=1333976">Renesas RA Family Standard Boot Firmware for the RA family MCUs Based on Arm® Cortex®-M33</a><br>
3、<a href="https://www.renesas.com/us/en/document/apn/renesas-ra-family-device-lifecycle-management-key-installation?language=en&amp;r=1333976">Renesas RA Family Device Lifecycle Management Key Injection</a><br>
4、<a href="https://www.renesas.cn/cn/zh/document/apn/renesas-ra-family-device-lifecycle-management-key-installation">瑞萨 RA 产品家族 器件生命周期管理密钥安装</a><br>
5、<a href="https://www.renesas.cn/cn/zh/document/mat/security-key-management-tool-v103-users-manual">安全密钥管理工具 V.1.03 用户手册</a><br>
6、<a href="https://www.renesas.cn/cn/zh/document/apn/implementing-production-programming-tools-ra-cortex-m33-device-lifecycle-management">Renesas RA Family Implementing Production Programming Tools for<br>
RA Cortex-M33 with Device Lifecycle Management</a></p>
<h3 id="93-ra启动模式">9.3 RA启动模式 </h3>
<p><img src="./images/MD%20startup.png" alt=""></p>
<h4 id="931-boot硬件接口">9.3.1 boot硬件接口 </h4>
<p><img src="./images/boot%20interface1.png" alt=""><br>
<img src="./images/boot%20interface2.png" alt=""><br>
<img src="./images/boot%20interface3.png" alt=""><br>
硬件设计建议预留MD引脚和jtag接口，而非单独swd接口。</p>
<h4 id="932-boot软件接口">9.3.2 boot软件接口 </h4>
<p>1、uart/usb boot协议<br>
2、RFPV3.exe、rfp-cli.exe、<br>
3、rpe.exe<br>
<img src="./images/rfp%20tool.png" alt=""></p>
<h3 id="94-ra-dlm生命周期管理">9.4 RA DLM（生命周期管理） </h3>
<p><strong>1、写入.rpd分区文件</strong><br>
<strong>2、读保护就是使用RFP切换CM/SSD模式切换到DPL模式</strong></p>
<h4 id="941-rpd分区文件">9.4.1 .rpd分区文件 </h4>
<p><strong>rpd文件会根据应用大小自动修改，只需用RFP烧写即可</strong><br>
<img src="./images/rpd.png" alt=""></p>
<h4 id="942-dlm介绍">9.4.2 DLM介绍 </h4>
<h5 id="9421-dlm模式转换图">9.4.2.1 DLM模式转换图 </h5>
<p><img src="./images/RA%20DLM%20lifecycles.png" alt=""></p>
<h5 id="9422-dlm模式说明图">9.4.2.2 DLM模式说明图 </h5>
<p><img src="./images/RA%20DLM%20list.png" alt=""><br>
<img src="./images/RA%20DLM%20list1.png" alt=""><br>
<img src="./images/RA%20DLM%20list2.png" alt=""></p>
<h5 id="9423-dlm-dpl部署到客户现场说明图">9.4.2.3 DLM-DPL部署到客户现场说明图 </h5>
<p><img src="./images/RA%20DLM%20DPL8.png" alt=""></p>
<h5 id="9424-dlm写入秘钥略">9.4.2.4 DLM写入秘钥（略） </h5>
<p>1、秘钥用于从DPL部署模式返回到SSD安全软件开发模式，即可以读写flash和相关配置。<br>
2、未写入秘钥则无法返回SSD模式，只能擦除整片flash（Initialize命令）<br>
3、非明文写入秘钥，需要使用瑞萨相关工具，不详细介绍了</p>
<h4 id="9425-dlm结合公司项目开发">9.4.2.5 DLM结合公司项目开发 </h4>
<p>| DLM模式| DLM备注| 公司项目阶段 | 权限 |<br>
| -- | -- | -- | --- | --- |<br>
|CM<br>芯片出厂| 用keil&amp;IAR开发，始终为该模式 | EVT |任意读写固件|<br>
|SSD<br>安全软件开发| 用e2s开发，自动切换到SSD | DVT | 公司可信任的开发人员 |<br>
|NSECSD<br>非安全软件开发|需要手动切换| DVT | 一般开发人员、测试人员 |<br>
|DPL<br>LCK_DBG<br>LCK_BOOT<br>用户现场|工厂生产流程<br>保护公司IP| PVT/MP | 一般用户 |<br>
|RMA_REQ<br>RMA_ACK<br>退货给瑞萨|故障分析|-| 瑞萨 |</p>
<h4 id="9426-演示rfp的使用">9.4.2.6 演示RFP的使用 </h4>
<p>1、RFP GUI<br>
RFPV3.exe和RFPV3.Console.exe<br>
2、rfp-cli.exe<br>
</p><pre class="language-text">EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, open 'd:\Users\jerry\Documents\GitHub\Renesas\RA6M5\images\rfp-cli.exe'</pre>  <br>
3、rpe.exe<br>
<pre class="language-text">EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, open 'd:\Users\jerry\Documents\GitHub\Renesas\RA6M5\images\rpe.exe'</pre>  <br>
4、RFP boot模式串口通讯协议<br>
<a href="https://www.renesas.cn/cn/zh/document/apn/standard-boot-firmware-ra-family-mcus-based-arm-cortex-m33?language=en&amp;r=1333976">Renesas RA Family Standard Boot Firmware for the RA family MCUs Based on Arm® Cortex®-M33</a><p></p>
<h4 id="9427-例程打印dlm模式和分区">9.4.2.7 例程打印DLM模式和分区 </h4>
<p>debug下载时候可以在console可以看见flash、sram分区的大小<br>
<img src="./images/rpd%20trust%20zone.png" alt=""><br>
<img src="./images/rpd%20trust%20zone1.png" alt=""><br>
<img src="./images/rpd%20trust%20zone2.png" alt=""><br>
<img src="./images/rpd%20trust%20zone3.png" alt=""><br>
<img src="./images/rpd%20trust%20zone4.png" alt=""></p>
<p>例程代码可用于用户产测程序：</p>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>    const char dlmlist[] = "0x1: CM 0x2: SSD 0x3: NSECSD 0x4: DPL 0x5: LCK_DBG 0x6: LCK_BOOT 0x7: RMA_REQ 0x8: RMA_ACK ";
    printf("%s\n", dlmlist);

    uint8_t dlm = R_PSCU-&gt;DLMMON_b.DLMMON;
    char dlm_str[20] = {0};
    sprintf(dlm_str, "dlm mode:%d\n", dlm);
    printf("%s", dlm_str);

    uint8_t cfs2 = R_PSCU-&gt;CFSAMONA_b.CFS2;
    sprintf(dlm_str, "cfs2:%d\n", cfs2);
    printf("%s", dlm_str);

    uint8_t cfs1 = R_PSCU-&gt;CFSAMONB_b.CFS1;
    sprintf(dlm_str, "cfs1:%d\n", cfs1);
    printf("%s", dlm_str);

    uint8_t dfs = R_PSCU-&gt;DFSAMON_b.DFS;
    sprintf(dlm_str, "dfs:%d\n", dfs);
    printf("%s", dlm_str);

    uint8_t ss2 = R_PSCU-&gt;SSAMONA_b.SS2;
    sprintf(dlm_str, "ss2:%d\n", ss2);
    printf("%s", dlm_str);

    uint8_t ss1 = R_PSCU-&gt;SSAMONB_b.SS1;
    sprintf(dlm_str, "ss1:%d\n", ss1);
    printf("%s", dlm_str);
</code></pre><h1 id="十-发布新固件-release和debug版本的差异">十、发布新固件---Release和Debug版本的差异 </h1>
<p>产品/项目小批量后会发布新固件，从而迭代新功能和修复bug等。可以通过如下方式升级：</p>
<ul>
<li>boot+app工厂引导在线升级</li>
<li>拉低MD引脚进入boot引导模式，串口升级</li>
<li>直接通过jtag/swd烧写</li>
</ul>
<p>所以，就需要发布新固件！</p>
<h2 id="101-公司自行管理维护">10.1 公司自行管理维护 </h2>
<p>宏定义、版本号、git、svn、测试、发布、烧录、升级</p>
<h2 id="102-release和debug版本的差异">10.2 Release和Debug版本的差异 </h2>
<h3 id="1021-引用文章">10.2.1 引用文章 </h3>
<p><img src="./images/rs.png" alt=""><br>
<a href="https://mp.weixin.qq.com/s?__biz=MzkxMzMyMTUzMg==&amp;mid=2247485928&amp;idx=2&amp;sn=a5d823b0434779d3d29cb0b2b159193a&amp;chksm=c17e32bbf609bbad873eadc476294785f822b215ad1febab3c1a60f34243d320a3253da26586&amp;scene=21&amp;token=1307419528&amp;lang=zh_CN#wechat_redirect">Release和Debug版本的差异</a><br>
<img src="./images/sh.png" alt=""><br>
<a href="https://mp.weixin.qq.com/s?__biz=MzI4MDI4MDE5Ng==&amp;mid=2247518681&amp;idx=1&amp;sn=6420fa1b40c32ad877b72605157a8d00&amp;chksm=ebb82432dccfad248a3acd1f2ce7b736f131f1b2877386434344e9c130b75c2f5f013698dd3c&amp;scene=21&amp;token=1307419528&amp;lang=zh_CN#wechat_redirect">IAR中 Debug 和 Release 区别是什么？</a></p>
<p><strong>主要功能与目的：</strong></p>
<ul>
<li>代码优化等级</li>
<li>预处理-调试信息</li>
<li>固件生成与合并</li>
<li>版本号管理</li>
<li>重命名固件</li>
<li>校验</li>
<li>备份</li>
</ul>
<h3 id="1022-个人观点">10.2.2 个人观点 </h3>
<ul>
<li>Release和Debug就是IDE给开发者提供一种管理调试和发布软件的功能。</li>
<li>个人不推荐使用该功能。</li>
<li>发布过程中可能碰到问题</li>
<li>依赖IDE、不利于中间层构建。</li>
</ul>
<p><img src="./images/middle.png" alt=""></p>
<h2 id="103-version存储">10.3 version存储 </h2>
<h3 id="1031-e2studio-version-section">10.3.1 e2studio .version Section </h3>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>SECTIONS
{
    ......
    .text :
    {
        __tz_FLASH_S = ABSOLUTE(FLASH_START);
        __ROM_Start = .;
        ......
        KEEP(*(.version))
        ......
    }
    ......
}


#define FSP_SECTION_VERSION      ".version"

/* BSP version structure. */
const fsp_version_t g_bsp_version =
{
    .api_version_minor  = BSP_API_VERSION_MINOR,
    .api_version_major  = BSP_API_VERSION_MAJOR,
    .code_version_major = BSP_CODE_VERSION_MAJOR,
    .code_version_minor = BSP_CODE_VERSION_MINOR
};

/* FSP pack version structure. */
static BSP_DONT_REMOVE const fsp_pack_version_t g_fsp_version BSP_PLACE_IN_SECTION (FSP_SECTION_VERSION) =
{
    .minor = FSP_VERSION_MINOR,
    .major = FSP_VERSION_MAJOR,
    .build = FSP_VERSION_BUILD,
    .patch = FSP_VERSION_PATCH
};

/* Public FSP version name. */
static BSP_DONT_REMOVE const uint8_t g_fsp_version_string[] BSP_PLACE_IN_SECTION(FSP_SECTION_VERSION) =
    FSP_VERSION_STRING;

/* Unique FSP version ID. */
static BSP_DONT_REMOVE const uint8_t g_fsp_version_build_string[] BSP_PLACE_IN_SECTION(FSP_SECTION_VERSION) =
    FSP_VERSION_BUILD_STRING;
</code></pre><h3 id="1032-绝对定位__attribute__at">10.3.2 绝对定位__attribute__((at())) </h3>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>__attribute__((at())) 
MDK AC5 AC6不同，不同IDE也有差异
</code></pre><p><a href="https://blog.csdn.net/cuihongqiang/article/details/104230363">使用__attribute__((at()))来进行绝对定位</a></p>
<pre data-role="codeBlock" data-info="" class="language-text text"><code>typedef struct {
    uint32_t magic_word;        /*!&lt; Magic word ESP_APP_DESC_MAGIC_WORD */
    uint32_t secure_version;    /*!&lt; Secure version */
    uint32_t reserv1[2];        /*!&lt; --- */
    char version[32];           /*!&lt; Application version */
    char project_name[32];      /*!&lt; Project name */
    char time[16];              /*!&lt; Compile time */
    char date[16];              /*!&lt; Compile date*/
    char idf_ver[32];           /*!&lt; Version IDF */
    uint8_t app_elf_sha256[32]; /*!&lt; sha256 of elf file */
    uint32_t reserv2[20];       /*!&lt; --- */
} sprt_app_desc_t;
 
/* MDK AC5 */
__attribute__((at(0x08000000))) const uint32_t cnt;
//cnt                                      0x08000000   Data           4  main.o(.ARM.__AT_0x08000000)
 
__attribute__((at(0x08000004))) const sprt_app_desc_t sprt_app_desc = {
	.version = "version",
	.time = __TIME__,
	.date = __DATE__,
};
//sprt_app_desc                            0x08000004   Data         256  main.o(.ARM.__AT_0x08000004)
 
__attribute__((at(0x20000000))) sprt_app_desc_t sprt_app_desc = {
	.version = "version",
	.time = __TIME__,
	.date = __DATE__,
};
//sprt_app_desc                            0x20000000   Data         256  main.o(.ARM.__AT_0x20000000)
 
__attribute__((at(0x20001000))) uint32_t cnt;
//cnt                                      0x20001000   Data           4  main.o(.ARM.__AT_0x20001000)
 
/* MDK AC6 */
/* section 等价 __section__ */
__attribute__((section(".ARM.__at_0x08000000"))) const uint32_t cnt;
//cnt                                      0x08000000   Data           4  main.o(.ARM.__at_0x08000000)
 
__attribute__((__section__(".ARM.__at_0x08000004"))) const sprt_app_desc_t sprt_app_desc = {
	.version = "version",
	.time = __TIME__,
	.date = __DATE__,
};
//sprt_app_desc                            0x08000004   Data         256  main.o(.ARM.__at_0x08000004)
 
__attribute__((section(".ARM.__at_0x20000000"))) uint32_t cnt;
//cnt                                      0x20000000   Data           4  main.o(.ARM.__at_0x20000000)
 
__attribute__((section(".ARM.__at_0x20000004"))) sprt_app_desc_t sprt_app_desc = {
	.version = "version",
	.time = __TIME__,
	.date = __DATE__,
};
//sprt_app_desc                            0x20000004   Data         256  main.o(.ARM.__at_0x20000004)
 
</code></pre><p><a href="https://blog.csdn.net/qq_20553613/article/details/123756967">https://blog.csdn.net/qq_20553613/article/details/123756967</a></p>

      </div>
      
      
    
    
    <script type="module">
// TODO: If ZenUML gets integrated into mermaid in the future,
//      we can remove the following lines.


var MERMAID_CONFIG = ({"startOnLoad":false});
if (typeof MERMAID_CONFIG !== 'undefined') {
  MERMAID_CONFIG.startOnLoad = false
  MERMAID_CONFIG.cloneCssStyles = false
  MERMAID_CONFIG.theme = "default"
}

mermaid.initialize(MERMAID_CONFIG || {})
if (typeof(window['Reveal']) !== 'undefined') {
  function mermaidRevealHelper(event) {
    var currentSlide = event.currentSlide
    var diagrams = currentSlide.querySelectorAll('.mermaid')
    for (var i = 0; i < diagrams.length; i++) {
      var diagram = diagrams[i]
      if (!diagram.hasAttribute('data-processed')) {
        mermaid.init(null, diagram, ()=> {
          Reveal.slide(event.indexh, event.indexv)
        })
      }
    }
  }
  Reveal.addEventListener('slidetransitionend', mermaidRevealHelper)
  Reveal.addEventListener('ready', mermaidRevealHelper)
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
} else {
  await mermaid.run({
    nodes: document.querySelectorAll('.mermaid')
  })
}
</script>
    
    
    
  
    </body></html>