<!DOCTYPE html><html><head>
      <title>README</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///c:\Users\jerry\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.8.13\crossnote\dependencies\katex\katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<p><strong>从0开始卷出一个新项目之瑞萨RZN2L</strong></p>

<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#一-rzn2l和工业以太网介绍" class="md-toc-link"><p>一、RZN2L和工业以太网介绍</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#11-范围" class="md-toc-link">
            <p>1.1 范围</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#12-目的" class="md-toc-link">
            <p>1.2、目的</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#13-瑞萨rzn2l简介" class="md-toc-link"><p>1.3、瑞萨RZN2L简介</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#131-外观与封装" class="md-toc-link">
            <p>1.3.1 外观与封装</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#132-官方介绍" class="md-toc-link">
            <p>1.3.2 官方介绍</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#133-芯片框图" class="md-toc-link">
            <p>1.3.3 芯片框图</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#134-目标应用" class="md-toc-link"><p>1.3.4 目标应用</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#1341-工业" class="md-toc-link">
            <p>1.3.4.1 工业</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#1342-building-automation-ba" class="md-toc-link">
            <p>1.3.4.2 Building Automation (BA)</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#14-工业以太网简介" class="md-toc-link">
            <p>1.4 工业以太网简介</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#15-mcu与mpu的区别简介" class="md-toc-link"><p>1.5 MCU与MPU的区别简介</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#151-电源和启动时序" class="md-toc-link">
            <p>1.5.1 电源和启动时序</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#152-外挂存贮和启动模式" class="md-toc-link">
            <p>1.5.2 外挂存贮和启动模式</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#153-内核" class="md-toc-link">
            <p>1.5.3 内核</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#154-操作系统" class="md-toc-link">
            <p>1.5.4 操作系统</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#二-硬件设计" class="md-toc-link"><p>二、硬件设计</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#21-参考资料文档" class="md-toc-link">
            <p>2.1 参考资料文档</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#22-硬件设计关键点" class="md-toc-link"><p>2.2 硬件设计关键点</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#221-电源和复位" class="md-toc-link">
            <p>2.2.1 电源和复位</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#222-启动模式和flash" class="md-toc-link"><p>2.2.2 启动模式和flash</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#2221-主要模式软硬件一致" class="md-toc-link">
            <p>2.2.2.1 主要模式（软硬件一致）</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#2222-硬件拨码" class="md-toc-link">
            <p>2.2.2.2 硬件拨码</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#2223-软件设置" class="md-toc-link">
            <p>2.2.2.3 软件设置</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#2224-flash选项和硬件设计" class="md-toc-link">
            <p>2.2.2.4 flash选项和硬件设计</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#2225-flash保存参数功能" class="md-toc-link">
            <p>2.2.2.5 flash保存参数功能</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#223-以太网和phy" class="md-toc-link">
            <p>2.2.3 以太网和phy</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#224-ecat-eeprom" class="md-toc-link">
            <p>2.2.4 ECAT EEPROM</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#225-时钟" class="md-toc-link">
            <p>2.2.5 时钟</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#226-debug" class="md-toc-link">
            <p>2.2.6 debug</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#227-sdram" class="md-toc-link">
            <p>2.2.7 SDRAM</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#228-其他通讯接口" class="md-toc-link">
            <p>2.2.8 其他通讯接口</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#229-未使用引脚" class="md-toc-link">
            <p>2.2.9 未使用引脚</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#三-软件设计" class="md-toc-link"><p>三、软件设计</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#31-开发环境相关" class="md-toc-link"><p>3.1 开发环境相关</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#311-ide下载-安装和设置" class="md-toc-link">
            <p>3.1.1 IDE下载、安装和设置</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#312-fsp软件包安装和更新" class="md-toc-link">
            <p>3.1.2 FSP软件包安装和更新</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#313-fsp各项功能简介" class="md-toc-link">
            <p>3.1.3 FSP各项功能简介</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#314-fsp的复制与差分" class="md-toc-link">
            <p>3.1.4 FSP的复制与差分</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#315-向导新建工程和常用设置" class="md-toc-link">
            <p>3.1.5 向导新建工程和常用设置</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#316-导入工程" class="md-toc-link">
            <p>3.1.6 导入工程</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#317-debug调试和下载" class="md-toc-link"><p>3.1.7 debug调试和下载</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#3171-官方介绍" class="md-toc-link">
            <p>3.1.7.1 官方介绍</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#3172-e2studio-debug变量实时监控" class="md-toc-link">
            <p>3.1.7.2 e2studio debug变量实时监控</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#3173-iar-debug变量实时监控" class="md-toc-link">
            <p>3.1.7.3 Iar debug变量实时监控</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#3174-debug经验总结" class="md-toc-link">
            <p>3.1.7.4 debug经验总结</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#32-base-project构建" class="md-toc-link"><p>3.2 base project构建</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#321-systick定时器" class="md-toc-link">
            <p>3.2.1 systick定时器</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#322-多个stack" class="md-toc-link">
            <p>3.2.2 多个stack</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#323-tcm与sram" class="md-toc-link">
            <p>3.2.3 TCM与SRAM</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#324-链接脚本与启动模式" class="md-toc-link">
            <p>3.2.4 链接脚本与启动模式</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#325-sram首选和atcm次选" class="md-toc-link">
            <p>3.2.5 SRAM首选和ATCM次选</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#326-串口5和dma" class="md-toc-link">
            <p>3.2.6 串口5和DMA</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#327-bus-master" class="md-toc-link">
            <p>3.2.7 bus master</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#328-segger-rtt" class="md-toc-link">
            <p>3.2.8 segger rtt</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#329-总结" class="md-toc-link"><p>3.2.9 总结</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#3291-单工程" class="md-toc-link">
            <p>3.2.9.1 单工程</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#3292-loadapp" class="md-toc-link">
            <p>3.2.9.2 load+app</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#33-日志系统" class="md-toc-link">
            <p>3.3 日志系统</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#34-中间层构建" class="md-toc-link"><p>3.4 中间层构建</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#341-了解e2s和fsp" class="md-toc-link">
            <p>3.4.1 了解e2s和fsp</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#342-fsp工程目录结构简介" class="md-toc-link">
            <p>3.4.2 fsp工程目录结构简介</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#五--rzt2l-基于官方开发套件的baseproject-coremark移植" class="md-toc-link">
            <p>五、 RZ/T2L-基于官方开发套件的BaseProject-coremark移植</p>

          </a></div><details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#六-loader-app分离工程" class="md-toc-link"><p>六、loader app分离工程</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#61-概述" class="md-toc-link">
            <p>6.1 概述</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#62-官方资料与不足" class="md-toc-link">
            <p>6.2 官方资料与不足</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#63-loader-app分离工程的优化" class="md-toc-link"><p>6.3 loader app分离工程的优化</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#631-自动调节合并appsection" class="md-toc-link">
            <p>6.3.1 自动调节合并appsection</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#632-loader中使用外设" class="md-toc-link">
            <p>6.3.2 loader中使用外设</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#633-app使用sram-mirror" class="md-toc-link">
            <p>6.3.3 app使用sram mirror</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#634-sram-atcm同时使用" class="md-toc-link">
            <p>6.3.4 sram atcm同时使用</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
</div>
<h1 id="一-rzn2l和工业以太网介绍">一、RZN2L和工业以太网介绍 </h1>
<h2 id="11-范围">1.1 范围 </h2>
<ul>
<li>熟悉mcu，未使用过mpu</li>
<li>熟悉cortex M3，未使用过cortex R52</li>
<li>熟悉工业现场总线和工业以太网</li>
</ul>
<p><a href="https://developer.arm.com/documentation/102199/0001/?lang=en">https://developer.arm.com/documentation/102199/0001/?lang=en</a></p>
<h2 id="12-目的">1.2、目的 </h2>
<p>在企业和开发者的角度，从介绍芯片、介绍工业以太网、硬件设计、软件设计、生产流程、升级固件共6个方面分享RZN2L相关经营。<br>
<strong>☆快速上手，少走弯路</strong></p>
<h2 id="13-瑞萨rzn2l简介">1.3、瑞萨RZN2L简介 </h2>
<h3 id="131-外观与封装">1.3.1 外观与封装 </h3>
<p><img src="./images/bga.png" alt=""></p>
<h3 id="132-官方介绍">1.3.2 官方介绍 </h3>
<p><img src="./images/rzn2l.png" alt=""></p>
<h3 id="133-芯片框图">1.3.3 芯片框图 </h3>
<p><img src="./images/rzn2l-block_1.png" alt=""><br>
<img src="./images/rzn2l-block_2.png" alt=""></p>
<h3 id="134-目标应用">1.3.4 目标应用 </h3>
<h4 id="1341-工业">1.3.4.1 工业 </h4>
<p><img src="./images/application.png" alt=""></p>
<h4 id="1342-building-automation-ba">1.3.4.2 Building Automation (BA) </h4>
<p><img src="./images/BACnet.png" alt=""></p>
<h2 id="14-工业以太网简介">1.4 工业以太网简介 </h2>
<p><img src="./images/iiot1.png" alt=""><br>
<img src="./images/rz%20iiot3.png" alt=""><br>
<img src="./images/product%20line.png" alt=""><br>
<img src="./images/industry%20Ethernet.png" alt=""></p>
<h2 id="15-mcu与mpu的区别简介">1.5 MCU与MPU的区别简介 </h2>
<h3 id="151-电源和启动时序">1.5.1 电源和启动时序 </h3>
<p><img src="./images/power%20on.png" alt=""></p>
<h3 id="152-外挂存贮和启动模式">1.5.2 外挂存贮和启动模式 </h3>
<ul>
<li>Nor Flash</li>
<li>Nand Flash</li>
<li>SDRAM</li>
<li>DDR<br>
<img src="./images/ssbl.png" alt=""></li>
</ul>
<h3 id="153-内核">1.5.3 内核 </h3>
<p><img src="./images/M3.png" alt=""><br>
<img src="./images/R52.png" alt=""><br>
<img src="./images/A9.png" alt=""></p>
<ul>
<li>R52:<a href="./DOC/arm_cortex_r52plus_processor_trm_102199_0001_02_en.pdf">arm_cortex_r52plus_processor_trm_102199_0001_02_en.pdf</a></li>
</ul>
<h3 id="154-操作系统">1.5.4 操作系统 </h3>
<ul>
<li>裸跑</li>
<li>RTOS</li>
<li>Linux</li>
</ul>
<h1 id="二-硬件设计">二、硬件设计 </h1>
<h2 id="21-参考资料文档">2.1 参考资料文档 </h2>
<ul>
<li>
<p><a href="./DOC/rzn2l-group-datasheet.pdf">rzn2l-group-datasheet.pdf</a></p>
</li>
<li>
<p><a href="./DOC/rzn2l-group-users-manual-hardware.pdf">rzn2l-group-users-manual-hardware.pdf</a></p>
</li>
<li>
<p><a href="./DOC/rzn2l-easy-download-guide.pdf">rzn2l-easy-download-guide.pdf</a></p>
</li>
<li>
<p><a href="./DOC/renesas-rzn2l-group.pdf">renesas-rzn2l-group.pdf</a></p>
</li>
<li>
<p><a href="./DOC/rzt2m-rzn2l-group-hardware-design-guide.pdf">rzt2m-rzn2l-group-hardware-design-guide.pdf</a></p>
</li>
<li>
<p><strong>RSK:</strong></p>
</li>
<li>
<p><a href="./DOC/Kit/RSK/rskplus-rzn2l-v1-schematic.pdf">rskplus-rzn2l-v1-schematic.pdf</a></p>
</li>
<li>
<p><strong>CN032:</strong></p>
</li>
<li>
<p><a href="./DOC/Kit/CN032/CN032-1%20Industry%20EtherCAT%20Servo%20Controller-RZN2L_SCH.pdf">CN032-1 Industry EtherCAT Servo Controller-RZN2L_SCH.pdf</a></p>
</li>
</ul>
<h2 id="22-硬件设计关键点">2.2 硬件设计关键点 </h2>
<h3 id="221-电源和复位">2.2.1 电源和复位 </h3>
<ul>
<li>上电时序：PMIC greenpak cpld 阻容</li>
<li>MDVn：3.3v</li>
<li>AVCC<br>
<img src="./images/power%20on.png" alt=""></li>
</ul>
<p><img src="./images/power1.png" alt=""><br>
<img src="./images/power2.png" alt=""><br>
<img src="./images/power6.png" alt=""><br>
<img src="./images/power3.png" alt=""></p>
<p><img src="./images/power4.png" alt=""><br>
<img src="./images/power5.png" alt=""></p>
<h3 id="222-启动模式和flash">2.2.2 启动模式和flash </h3>
<h4 id="2221-主要模式软硬件一致">2.2.2.1 主要模式（软硬件一致） </h4>
<ul>
<li>ram boot</li>
<li>xspi boot---qspi---000</li>
<li>sci（uart）boot</li>
<li>usb boot</li>
</ul>
<h4 id="2222-硬件拨码">2.2.2.2 硬件拨码 </h4>
<p><img src="./images/boot1.png" alt=""></p>
<h4 id="2223-软件设置">2.2.2.3 软件设置 </h4>
<p><img src="./images/flash-fsp.png" alt=""></p>
<h4 id="2224-flash选项和硬件设计">2.2.2.4 flash选项和硬件设计 </h4>
<ul>
<li>flash qspi：AT25，W25，mx25</li>
<li>电源1.8v/3.3v，软硬件要一致</li>
<li>不同flash的寄存器要检查，iar boot是否支持<br>
<img src="./images/flash-rsk.png" alt=""><br>
<img src="./images/qspi.png" alt=""><br>
<img src="./images/boot%20mode.png" alt=""></li>
</ul>
<h4 id="2225-flash保存参数功能">2.2.2.5 flash保存参数功能 </h4>
<ul>
<li>确认xspi的真正协议（spi、dspi、qspi、ospi....）</li>
<li>核对flash的寄存器地址</li>
<li>优化的xspi_qspi例程（如何验证参数100%保存成功了）</li>
<li>给出优化的例程和测试日志<br>
<img src="./images/flash-xspipins.png" alt=""><br>
<img src="./images/flash-addr.png" alt=""><br>
<img src="./images/flash-qspidemo.png" alt=""></li>
<li>原例程ram启动；优化为xspi flash启动断电验证保存参数</li>
<li>原例程参数地址会被固件覆盖，无法连续测试；优化为固件后安全底座</li>
<li>原例程ram debug测试；优化为串口日志，方便理解整个流程，保证断电保存参数</li>
</ul>
<pre data-role="codeBlock" data-info="" class="language-text"><code>Hello World
========================FLASH===========================
0x6000 0000*********************************************
0x6000 1000*************Frameware***********************
0x6000 2000*********************************************
********************************************************
********************************************************
********************************************************
0x6001 0000*************Test Addr***********************
0x6001 1000*************Test Addr***********************
********************************************************
********************************************************
********************************************************
========================================================
[QSPI_Open]:successed!
[Quad_Mode_enable]:successed!
--------------------------------------------------------
Power On Read!
[Pointer Read]:0x4000 0000 + 0x10234
12
[Pointer Read]:0x4000 0000 + 0x10000
00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 
--------------------------------------------------------
[Erase] successed!: addr:0x60010000, len:4096
[DirectTransfe WRITE] successed!: cmd:0x06
[DirectTransfe WRITE] successed!: cmd:0x02, addr:0x10234, data:0x12
[DirectTransfe READ] successed!: cmd:0xEB, addr:0x10234, data:0x12
[Verify-1] successed! line:154
--------------------------------------------------------
[Read] successed!: addr:0x6000 0000-0x2000 0000+0x10234, read_buffer:0x12
[Verify-2] successed! line:168
--------------------------------------------------------
[QSPI_Write] addr:0x6000 0000-0x2000 0000+0x10000:
00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35 36 37 38 39 3A 3B 3C 3D 3E 3F 
[QSPI_Write] successed!
[QSPI_Read] addr:0x6000 0000-0x2000 0000+0x10000:
00 01 02 03 0
</code></pre><h3 id="223-以太网和phy">2.2.3 以太网和phy </h3>
<ul>
<li>RGMII</li>
<li>MII 兼容</li>
</ul>
<p><img src="./images/phy1.png" alt=""><br>
<img src="./images/phy3.png" alt=""><br>
<img src="./images/phy2.png" alt=""></p>
<h3 id="224-ecat-eeprom">2.2.4 ECAT EEPROM </h3>
<ul>
<li>phylink</li>
<li>phyact</li>
<li>ecatled<br>
<img src="./images/phy3.png" alt=""><br>
<img src="./images/eeprom.png" alt=""><br>
<img src="./images/ecat.png" alt=""></li>
</ul>
<h3 id="225-时钟">2.2.5 时钟 </h3>
<ul>
<li>25M无源晶振</li>
<li>有源晶振</li>
<li>EXTCLKIN接地<br>
<img src="./images/clock.png" alt=""><br>
<img src="./images/clock1.png" alt=""></li>
</ul>
<h3 id="226-debug">2.2.6 debug </h3>
<ul>
<li>jtag/swd</li>
<li>BSCANP接地</li>
<li>MDD jtag非加密<br>
<img src="./images/debug1.png" alt=""><br>
<img src="./images/debug2.png" alt=""><br>
<img src="./images/debug3.png" alt=""></li>
</ul>
<h3 id="227-sdram">2.2.7 SDRAM </h3>
<ul>
<li>pn预留</li>
</ul>
<h3 id="228-其他通讯接口">2.2.8 其他通讯接口 </h3>
<ul>
<li>
<p>log uart1 p16-5<br>
<img src="./images/log.png" alt=""></p>
</li>
<li>
<p>RS485</p>
</li>
<li>
<p>CAN</p>
</li>
<li>
<p>Encoder</p>
</li>
<li>
<p>spi</p>
</li>
<li>
<p>xspi</p>
</li>
<li>
<p>adc</p>
</li>
<li>
<p>usb</p>
</li>
<li>
<p>pwm</p>
</li>
</ul>
<p>34一组 67一组 互补PWM电机控制输出接口<br>
MTU34			<br>
MTIOC3B, MTIOC3D		<br>
MTIOC4A, MTIOC4C		<br>
MTIOC4B, MTIOC4D		<br>
MTU67			<br>
MTIOC6B, MTIOC6D		<br>
MTIOC7A, MTIOC7C		<br>
MTIOC7B, and MTIOC7D</p>
<h3 id="229-未使用引脚">2.2.9 未使用引脚 </h3>
<p><img src="./images/unused.png" alt=""></p>
<h1 id="三-软件设计">三、软件设计 </h1>
<h2 id="31-开发环境相关">3.1 开发环境相关 </h2>
<ul>
<li>适用范围：适合未使用过eclipse的同学</li>
<li>本章只讲e2s，不讲IAR（没有W）</li>
</ul>
<h3 id="311-ide下载-安装和设置">3.1.1 IDE下载、安装和设置 </h3>
<ul>
<li><strong>强烈推荐e2studio 2023-10 + RZN_FSP_Packs_v1.2.0</strong></li>
<li>e2s安装lite</li>
<li>安装简体中文，可切换英文</li>
<li>RZ不支持在线安装FSP</li>
<li>编译工具添加到环境变量</li>
<li>注意安装失败提示</li>
<li>release note</li>
<li>e2s工作空间</li>
<li>显示隐藏的前进后退按钮<br>
<img src="./images/ide.png" alt=""><br>
<img src="./images/download2.png" alt=""></li>
</ul>
<p><img src="./images/install1.png" alt=""><br>
<img src="./images/install2.png" alt=""><br>
<img src="./images/install3.png" alt=""><br>
<img src="./images/install4.png" alt=""><br>
<img src="./images/install5.png" alt=""><br>
<img src="./images/install6.png" alt=""><br>
<img src="./images/install7.png" alt=""><br>
<img src="./images/install8.png" alt=""><br>
<img src="./images/install9.png" alt=""><br>
<img src="./images/install10.png" alt=""><br>
<img src="./images/install11.png" alt=""><br>
<img src="./images/install12.png" alt=""><br>
<img src="./images/shitu2.png.png" alt=""></p>
<h3 id="312-fsp软件包安装和更新">3.1.2 FSP软件包安装和更新 </h3>
<ul>
<li><strong>再次强烈推荐e2studio 2023-10 + RZN_FSP_Packs_v1.2.0</strong></li>
<li>安装多个版本fsp<br>
<img src="./images/download4.png" alt=""></li>
</ul>
<h3 id="313-fsp各项功能简介">3.1.3 FSP各项功能简介 </h3>
<p><img src="./images/src.png" alt=""></p>
<h3 id="314-fsp的复制与差分">3.1.4 FSP的复制与差分 </h3>
<ul>
<li>导入其他工程stack</li>
<li>pin导出csv</li>
<li>多套pins配置</li>
<li>pins导入导出</li>
<li>configuration.xml差分<br>
<img src="./images/fsp1.png" alt=""><br>
<img src="./images/fsp2.png" alt=""><br>
<img src="./images/fsp3.png" alt=""><br>
<img src="./images/fsp4.png" alt=""></li>
</ul>
<h3 id="315-向导新建工程和常用设置">3.1.5 向导新建工程和常用设置 </h3>
<p><img src="./images/projectset1.png" alt=""><br>
<img src="./images/projectset2.png" alt=""></p>
<h3 id="316-导入工程">3.1.6 导入工程 </h3>
<ul>
<li>单个工程文件夹（文件夹或压缩包），建议勾选复制到工作空间</li>
<li>多个工厂文件夹（可能需要复制到工作空间下）<br>
<img src="./images/import1.png" alt=""></li>
</ul>
<h3 id="317-debug调试和下载">3.1.7 debug调试和下载 </h3>
<h4 id="3171-官方介绍">3.1.7.1 官方介绍 </h4>
<ul>
<li>官网：<br>
<img src="./images/debug-official%20website%20doc.png" alt=""></li>
<li>datasheet：<br>
<img src="./images/debug-datasheet.png" alt=""></li>
<li>user manual：<br>
<img src="./images/debug-usermanual.png" alt=""></li>
<li>coresight：<br>
1.coresight---source insight<br>
2.<a href="./DOC/arm_cortex_r52_processor_trm_100026_0104_00_en.pdf">arm_cortex_r52_processor_trm_100026_0104_00_en.pdf</a><br>
3.<a href="https://developer.arm.com/Processors/Cortex-R52#Technical-Specifications">https://developer.arm.com/Processors/Cortex-R52#Technical-Specifications</a><br>
4.<a href="https://wiki.segger.com/DCC">https://wiki.segger.com/DCC</a><br>
<img src="./images/debug-coresight.png" alt=""><br>
5.<a href="https://zhuanlan.zhihu.com/p/149519501">https://zhuanlan.zhihu.com/p/149519501</a></li>
<li>快速开始指南<br>
<a href="./DOC/rzt2rzn2-getting-started-flexible-software-package.pdf">rzt2rzn2-getting-started-flexible-software-package.pdf</a><br>
<img src="./images/debug-startguide1.png" alt=""><br>
<img src="./images/debug-xspi-systeminit.png" alt=""></li>
<li>debug configuration修改cpsr<br>
<img src="./images/install13.png" alt=""></li>
</ul>
<h4 id="3172-e2studio-debug变量实时监控">3.1.7.2 e2studio debug变量实时监控 </h4>
<p><img src="./images/debug-e2s.png" alt=""></p>
<h4 id="3173-iar-debug变量实时监控">3.1.7.3 Iar debug变量实时监控 </h4>
<ul>
<li>瑞萨嵌入式小百科<a href="https://mp.weixin.qq.com/s/GPN6CGonTs6Cy75KHg_wPg">如何在IAR IDE中使用基于Cortex-R52的RZ/T&amp;N MPU的变量实时监控</a></li>
<li><a href="https://www.bilibili.com/video/BV1MN4y1D7WP/?spm_id_from=333.999.0.0&amp;vd_source=21efa952a2d53fd4f04dc76ba0278b18">https://www.bilibili.com/video/BV1MN4y1D7WP/?spm_id_from=333.999.0.0&amp;vd_source=21efa952a2d53fd4f04dc76ba0278b18</a></li>
</ul>
<h4 id="3174-debug经验总结">3.1.7.4 debug经验总结 </h4>
<p><img src="./images/debug-tool.png" alt=""></p>
<h2 id="32-base-project构建">3.2 base project构建 </h2>
<ul>
<li>目标：构建一个通用的、排除各种“小毛刺”的、TCM SRAM可同时使用的、可用于产品开发级的base project。以备后续移植日志系统、中间层、公司平台产品。这里只是分享经营，抛砖引玉。</li>
</ul>
<h3 id="321-systick定时器">3.2.1 systick定时器 </h3>
<p><strong>本节之后，通过移植coremark来分析和理解RZN2L(R52)不同于cortex M3的一些要点，最终的目的是创建一个通用的base project，这样我们的一个适用于产品级的RZN2L平台就创建出来了。</strong></p>
<p><strong>移植cormark关键点：</strong></p>
<ul>
<li>时钟：只有cortex M才有systick timer</li>
<li>迭代次数：#define ITERATIONS 20000</li>
<li>编译器和优化等级：COMPILER_VERSION，COMPILER_FLAGS</li>
<li>printf重定向一样</li>
<li>coremark结果只用于理解芯片和对比ATCM SRAM</li>
</ul>
<pre data-role="codeBlock" data-info="" class="language-text"><code>//void SysTick_Handler(void)
//{
//    cnt++;
//}
</code></pre><pre data-role="codeBlock" data-info="" class="language-text"><code>/*
* g_timer0CB
* rzn2l core R52 havenot systick, so init g_timer0 cnt
*/
extern volatile clock_t cnt;
void g_timer0CB(timer_callback_args_t *p_args)
{
   if (TIMER_EVENT_CYCLE_END == p_args-&gt;event)
   {
       cnt++;
   }
}
</code></pre><h3 id="322-多个stack">3.2.2 多个stack </h3>
<ul>
<li>coremark结果失败，但未提示stack溢出<br>
<img src="./images/stack1.png" alt=""><br>
<img src="./images/stack2.png" alt=""></li>
</ul>
<pre data-role="codeBlock" data-info="" class="language-text"><code>[16:09:06.088]收←◆2K performance run parameters for coremark.
[0]ERROR! list crc 0x7271 - should be 0xe714
[0]ERROR! matrix crc 0x7fc1 - should be 0x1fd7
[0]ERROR! state crc 0x44f1 - should be 0x8e3a
CoreMark Size    : 666
Total ticks      : 30024
Total time (secs): 30.024000
Iterations/Sec   : 666.133760
Iterations       : 20000
Compiler version : GCC10.3.1 20210824 (release)
Compiler flags   : Please put compiler flags here (e.g. -o3)
Memory location  : STACK
seedcrc          : 0xe9f5
[0]crclist       : 0x7271
[0]crcmatrix     : 0x7fc1
[0]crcstate      : 0x44f1
[0]crcfinal      : 0xf1c1
Errors detected
</code></pre><pre data-role="codeBlock" data-info="" class="language-text"><code>[12:37:01.637]收←◆hello word!
date:Oct 17 2023
time:12:36:15
file:../src/hal_entry.c
func:hal_entry,line:126
hello world!
PI=3.141593
start coremain!!!

[12:37:16.656]收←◆2K performance run parameters for coremark.
CoreMark Size    : 666
Total ticks      : 15006
Total time (secs): 15.006000
Iterations/Sec   : 1332.800213
Iterations       : 20000
Compiler version : GCC10.3.1 20210824 (release)
Compiler flags   : Please put compiler flags here (e.g. -o3)
Memory location  : STACK
seedcrc          : 0xe9f5
[0]crclist       : 0xe714
[0]crcmatrix     : 0x1fd7
[0]crcstate      : 0x8e3a
[0]crcfinal      : 0x382f
Correct operation validated. See README.md for run and reporting rules.
CoreMark 1.0 : 1332.800213 / GCC10.3.1 20210824 (release) Please put compiler flags here (e.g. -o3) / STACK
FSP_PRIV_CLOCK_CPU0=400000000
running!!!
</code></pre><h3 id="323-tcm与sram">3.2.3 TCM与SRAM </h3>
<ul>
<li>目标对比TCM与SRAM执行速度</li>
<li>coremark结果处理编译器、优化等级外，主要受text data，次要stack heap</li>
<li>所以需要修改ld</li>
</ul>
<h3 id="324-链接脚本与启动模式">3.2.4 链接脚本与启动模式 </h3>
<ul>
<li>参考例程修改ld ATCM-&gt;sram mirror</li>
<li>./script/fsp_xspi0_boot.ld fsp_ram_execution.ld自动更新</li>
<li>xspi0 boot流程</li>
<li>startup.c复制初始化内存数据<br>
<img src="./images/boot%20process.png" alt=""><br>
<img src="./images/boot%20process1.png" alt=""></li>
</ul>
<pre data-role="codeBlock" data-info="" class="language-text"><code>hello word!
date:Oct 17 2023
time:12:38:17
file:../src/hal_entry.c
func:hal_entry,line:126
hello world!
PI=3.141593
start coremain!!!

[12:39:30.771]收←◆2K performance run parameters for coremark.
CoreMark Size    : 666
Total ticks      : 34391
Total time (secs): 34.391000
Iterations/Sec   : 581.547498
Iterations       : 20000
Compiler version : GCC10.3.1 20210824 (release)
Compiler flags   : Please put compiler flags here (e.g. -o3)
Memory location  : STACK
seedcrc          : 0xe9f5
[0]crclist       : 0xe714
[0]crcmatrix     : 0x1fd7
[0]crcstate      : 0x8e3a
[0]crcfinal      : 0x382f
Correct operation validated. See README.md for run and reporting rules.
CoreMark 1.0 : 581.547498 / GCC10.3.1 20210824 (release) Please put compiler flags here (e.g. -o3) / STACK
FSP_PRIV_CLOCK_CPU0=400000000
running!!!
</code></pre><h3 id="325-sram首选和atcm次选">3.2.5 SRAM首选和ATCM次选 </h3>
<ul>
<li>修改ld文件和startup.c文件</li>
</ul>
<pre data-role="codeBlock" data-info="" class="language-text"><code>.atcm_text  : AT (_matcm_text)
    {
        _atcm_text_start = .;
        ./src/coremark/*.o(.text*)
        _atcm_text_end = .;
    } &gt; ATCM
    
    .atcm_data  : AT (_matcm_data)
    {
        _atcm_data_start = .;
        
        __atcm_data_start = .;
        ./src/coremark/*.o(.data*)
        __atcm_data_end = .;   
      
        __atcm_bss_start = .;
        ./src/coremark/*.o(.bss*)
        ./src/coremark/*.o(COMMON)
        __atcm_bss_end = . ;    
        
        _atcm_data_end = .;   
    } &gt; ATCM
</code></pre><pre data-role="codeBlock" data-info="" class="language-text"><code>#if FSP_XSPI0_BOOT_SRAM_ATCM//fsp_xspi0_boot_SRAM_ATCM.ld
            "    ldr  r0, =_matcm_text                      \n"
            "    ldr  r1, =_atcm_text_start                 \n"
            "    ldr  r2, =_atcm_text_end                   \n"
            "    cmp  r2, r1                           \n"
            "    beq  copy_ATCM_APP_TEXT_end                \n"

            "copy_to_ATCM_APP_TEXT:                         \n"
            "    ldrb  r3, [r0], #0                    \n"
            "    strb  r3, [r1], #0                    \n"
            "    add   r0, r0, #1                      \n"
            "    add   r1, r1, #1                      \n"
            "    cmp   r2, r1                          \n"
            "    bne   copy_to_ATCM_APP_TEXT                \n"
            "copy_ATCM_APP_TEXT_end:                        \n"
            "    dsb                                   \n" /* Ensuring data-changing */

            "    ldr  r0, =_matcm_data                      \n"
            "    ldr  r1, =_atcm_data_start                 \n"
            "    ldr  r2, =_atcm_data_end                   \n"
            "    cmp  r2, r1                           \n"
            "    beq  copy_ATCM_APP_DATA_end                \n"

            "copy_to_ATCM_APP_DATA:                         \n"
            "    ldrb  r3, [r0], #0                    \n"
            "    strb  r3, [r1], #0                    \n"
            "    add   r0, r0, #1                      \n"
            "    add   r1, r1, #1                      \n"
            "    cmp   r2, r1                          \n"
            "    bne   copy_to_ATCM_APP_DATA                \n"
            "copy_ATCM_APP_DATA_end:                        \n"
            "    dsb                                   \n" /* Ensuring data-changing */
#endif
</code></pre><pre data-role="codeBlock" data-info="" class="language-text"><code>hello word!
date:Oct 17 2023
time:12:40:42
file:../src/hal_entry.c
func:hal_entry,line:126
hello world!
PI=3.141593
start coremain!!!

[12:41:37.160]收←◆2K performance run parameters for coremark.
CoreMark Size    : 666
Total ticks      : 14924
Total time (secs): 14.924000
Iterations/Sec   : 1340.123291
Iterations       : 20000
Compiler version : GCC10.3.1 20210824 (release)
Compiler flags   : Please put compiler flags here (e.g. -o3)
Memory location  : STACK
seedcrc          : 0xe9f5
[0]crclist       : 0xe714
[0]crcmatrix     : 0x1fd7
[0]crcstate      : 0x8e3a
[0]crcfinal      : 0x382f
Correct operation validated. See README.md for run and reporting rules.
CoreMark 1.0 : 1340.123291 / GCC10.3.1 20210824 (release) Please put compiler flags here (e.g. -o3) / STACK
FSP_PRIV_CLOCK_CPU0=400000000
running!!!
</code></pre><h3 id="326-串口5和dma">3.2.6 串口5和DMA </h3>
<ul>
<li>串口5不支持dma功能</li>
</ul>
<p><img src="./images/safety1.png" alt=""><br>
<img src="./images/safety2.png" alt=""></p>
<h3 id="327-bus-master">3.2.7 bus master </h3>
<p><img src="./images/bus1.png" alt=""></p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>/* region 0 (ATCM) */
#define EL1_MPU_REGION00_BASE_L     (0x0000 &amp; 0xFFC0) + OUTER_SHAREABLE + EL1RW_EL0RW + EXECUTE_ENABLE
#define EL1_MPU_REGION00_BASE_H     (0x0000 &amp; 0xFFFF)
#define EL1_MPU_REGION00_LIMIT_L    (0xFFFF &amp; 0xFFC0) + ATTRINDEX3 + REGION_ENABLE
#define EL1_MPU_REGION00_LIMIT_H    (0x0001 &amp; 0xFFFF)

/* region 1 (BTCM) */
#define EL1_MPU_REGION01_BASE_L     (0x0000 &amp; 0xFFC0) + OUTER_SHAREABLE + EL1RW_EL0RW + EXECUTE_ENABLE
#define EL1_MPU_REGION01_BASE_H     (0x0010 &amp; 0xFFFF)
#define EL1_MPU_REGION01_LIMIT_L    (0xFFFF &amp; 0xFFC0) + ATTRINDEX3 + REGION_ENABLE
#define EL1_MPU_REGION01_LIMIT_H    (0x0011 &amp; 0xFFFF)

/* region 2 (System RAM) */
#define EL1_MPU_REGION02_BASE_L     (0x0000 &amp; 0xFFC0) + NON_SHAREABLE + EL1RW_EL0RW + EXECUTE_ENABLE
#define EL1_MPU_REGION02_BASE_H     (0x1000 &amp; 0xFFFF)
#define EL1_MPU_REGION02_LIMIT_L    (0xFFFF &amp; 0xFFC0) + ATTRINDEX1 + REGION_ENABLE
#define EL1_MPU_REGION02_LIMIT_H    (0x1017 &amp; 0xFFFF)

/* region 3 (System RAM mirror) */
#define EL1_MPU_REGION03_BASE_L     (0x0000 &amp; 0xFFC0) + OUTER_SHAREABLE + EL1RW_EL0RW + EXECUTE_ENABLE
#define EL1_MPU_REGION03_BASE_H     (0x3000 &amp; 0xFFFF)
#define EL1_MPU_REGION03_LIMIT_L    (0xFFFF &amp; 0xFFC0) + ATTRINDEX3 + REGION_ENABLE
#define EL1_MPU_REGION03_LIMIT_H    (0x3017 &amp; 0xFFFF)
</code></pre><h3 id="328-segger-rtt">3.2.8 segger rtt </h3>
<ul>
<li>INIT()失败，不支持rtt？</li>
</ul>
<pre data-role="codeBlock" data-info="" class="language-text"><code>#define INIT()  {                                                                                    \
                  volatile SEGGER_RTT_CB* pRTTCBInit;                                                \
                  pRTTCBInit = (volatile SEGGER_RTT_CB*)((char*)&amp;_SEGGER_RTT + SEGGER_RTT_UNCACHED_OFF); \
                  do {                                                                               \
                    if (pRTTCBInit-&gt;acID[0] == '\0') {                                               \
                      _DoInit();                                                                     \
                    }                                                                                \
                  } while (0);                                                                       \
                }
</code></pre><h3 id="329-总结">3.2.9 总结 </h3>
<h4 id="3291-单工程">3.2.9.1 单工程 </h4>
<ul>
<li>在starup.c中引导norflash到sram和atcm，参考coremark工程</li>
</ul>
<h4 id="3292-loadapp">3.2.9.2 load+app </h4>
<p><a href="./DOC/r01an6737jj0110-rzn2l-separating-loader-and-application.pdf">r01an6737jj0110-rzn2l-separating-loader-and-application</a></p>
<ul>
<li>在loader中引导，在app中初始化</li>
<li>修改app ld sram-&gt;sram mirror</li>
<li>编译前手动clean loader或修改配置自动clean<br>
<img src="./images/clean1.jpg" alt=""><br>
<img src="./images/clean2.jpg" alt=""></li>
</ul>
<h2 id="33-日志系统">3.3 日志系统 </h2>
<ul>
<li>请参考从0卷出一个新项目之RA6M5系列。其中的支持同步异步打印，支持printf、littlefs、rtt等，并且其中的bug在fsp4.6.0已经修复了，可以参考移植。</li>
</ul>
<h2 id="34-中间层构建">3.4 中间层构建 </h2>
<h3 id="341-了解e2s和fsp">3.4.1 了解e2s和fsp </h3>
<ul>
<li>因为fsp（Flexible Software Package）实质是大系列（RA RZN等）整合软件包+代码生成工具。</li>
<li>精通编译器当然也可以不用e2s，甚至IDE，但个人感觉fsp是绕不开的。</li>
<li><a href="https://github.com/renesas/rzn-fsp%EF%BC%9A">https://github.com/renesas/rzn-fsp：</a></li>
<li>e2s的帮助功能</li>
</ul>
<p>Flexible Software Package (FSP) for Renesas RZ/N series.</p>
<p>FSP is the next generation Arm® MCU software package from Renesas, that enables secure devices and IoT connectivity through production ready peripheral drivers, FreeRTOS, and portable middleware stacks. FSP includes best-in-class HAL drivers with high performance and low memory footprint. Middleware stacks with FreeRTOS integration are included to ease implementation of complex modules like communication and security. The e² studio provides support with intuitive configurators and intelligent code generation to make programming and debugging easier and faster.</p>
<p>FSP uses an open software ecosystem and provides flexibility in using your preferred RTOS, legacy code, and third-party ecosystem solutions.</p>
<p>Related Links<br>
FSP Releases : <a href="https://github.com/renesas/rzn-fsp/releases">https://github.com/renesas/rzn-fsp/releases</a></p>
<p>FSP Documentation : <a href="https://renesas.github.io/rzn-fsp">https://renesas.github.io/rzn-fsp</a></p>
<p>RZ/N2L Product Information : <a href="https://www.renesas.com/rzn2l">https://www.renesas.com/rzn2l</a></p>
<p>e² studio : <a href="https://www.renesas.com/e2studio">https://www.renesas.com/e2studio</a></p>
<p>Support : <a href="https://www.renesas.com/support">https://www.renesas.com/support</a></p>
<p><img src="./images/help.png" alt=""></p>
<h3 id="342-fsp工程目录结构简介">3.4.2 fsp工程目录结构简介 </h3>
<p><img src="./images/xxx_prj.png" alt=""></p>
<h1 id="五--rzt2l-基于官方开发套件的baseproject-coremark移植">五、 RZ/T2L-基于官方开发套件的BaseProject-coremark移植 </h1>
<p><a href="./coremark%20for%20T2L/Baseproject%20for%20RZT2L.md">跳转</a></p>
<h1 id="六-loader-app分离工程">六、loader app分离工程 </h1>
<h2 id="61-概述">6.1 概述 </h2>
<p>对比“3.2 base project构建”中的单个工程，本章节介绍loader app分离的双工程。可以实现更为灵活和复杂的功能，例如多协议支持、固件升级等等。</p>
<h2 id="62-官方资料与不足">6.2 官方资料与不足 </h2>
<p><img src="./images/loaderapp9.png" alt=""></p>
<ul>
<li>例程源码<br>
RZN2L_bsp_xspi0bootx1_app<br>
RZN2L_bsp_xspi0bootx1_loader</li>
<li>文档<br>
<a href="./DOC/r01an6737ej0110-rzn2l-separating-loader-and-application.pdf">r01an6737ej0110-rzn2l-separating-loader-and-application.pdf</a></li>
<li>仅展示<br>
<img src="./images/loaderapp0.png" alt=""><br>
以官方loader app双工程为base去移植应用代码，会碰到很多问题</li>
</ul>
<h2 id="63-loader-app分离工程的优化">6.3 loader app分离工程的优化 </h2>
<h3 id="631-自动调节合并appsection">6.3.1 自动调节合并appsection </h3>
<p><img src="./images/loaderapp3.png" alt=""><br>
<img src="./images/loaderapp1.png" alt=""><br>
<img src="./images/loaderapp4.png" alt=""><br>
<img src="./images/loaderapp7.png" alt=""></p>
<h3 id="632-loader中使用外设">6.3.2 loader中使用外设 </h3>
<p><img src="./images/loaderapp5.png" alt=""><br>
<img src="./images/loaderapp6.png" alt=""><br>
<img src="./images/loaderapp2.png" alt=""><br>
<img src="./images/loaderapp8.png" alt=""></p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>//正确完整的编译loader+app
// 1: 必须首先clean loader，构建前增加make -r -j8 clean
// 2: 使能startu的初始化mpu代码 #if 1 // Original program
    /* Invalid these settings for loader project.
    * These settings are done in the application program.
    * Settings can also be made in the loader program if necessary. */

#if 1
    __enable_irq();
    g_uart0.p_api-&gt;open(g_uart0.p_ctrl, g_uart0.p_cfg);
    g_uart0.p_api-&gt;write(g_uart0.p_ctrl, (uint8_t const *)"Loader start!\n*****\nReady to Jump to the app!\n\n", strlen("Loader start!\n*****\nReady to Jump to the app!\n\n"));
    while(!uartTxCompleteFlg);
    uartTxCompleteFlg = 0;
    g_uart0.p_api-&gt;close(g_uart0.p_ctrl);
    __disable_irq();
#endif
</code></pre><h3 id="633-app使用sram-mirror">6.3.3 app使用sram mirror </h3>
<p>参考<a href="./rzn2l_coremark/script/fsp_xspi0_boot_SRAM_MIRROR.ld">fsp_xspi0_boot_SRAM_ATCM.ld</a></p>
<h3 id="634-sram-atcm同时使用">6.3.4 sram atcm同时使用 </h3>
<ul>
<li>参考<a href="./rzn2l_coremark/script/fsp_xspi0_boot_SRAM_MIRROR.ld">fsp_xspi0_boot_SRAM_ATCM.ld</a></li>
<li>在loader中复制atcm和sram</li>
</ul>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>